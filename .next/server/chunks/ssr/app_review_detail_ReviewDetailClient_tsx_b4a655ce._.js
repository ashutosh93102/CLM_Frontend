module.exports=[85841,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(50944),e=a.i(52072),f=a.i(98448),g=a.i(70106);let h=(0,g.default)("arrow-left",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);var i=a.i(5784),j=a.i(84505),k=a.i(77156),l=a.i(4720),m=a.i(23025),n=a.i(15618),o=a.i(87532);let p=(0,g.default)("triangle-alert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]),q=a=>Array.isArray(a)?a:[],r=a=>{if(!a||"object"!=typeof a)return{label:"Date",value:String(a||"")};let b=String(a.label||a.name||"Date"),c=String(a.value||a.date||a.text||""),d=String(a.type||a.kind||"").toLowerCase();return{label:b,value:c,color:d.includes("expire")?"rose":d.includes("effective")?"amber":"slate"}},s=({children:a,tone:c="slate"})=>{let d={slate:"bg-slate-50 text-slate-700 border-slate-200",amber:"bg-amber-50 text-amber-700 border-amber-200",rose:"bg-rose-50 text-rose-700 border-rose-200",emerald:"bg-emerald-50 text-emerald-700 border-emerald-200",violet:"bg-violet-50 text-violet-700 border-violet-200"};return(0,b.jsx)("span",{className:`inline-flex items-center gap-2 px-3 py-1 rounded-full text-xs font-semibold border ${d[c]||d.slate}`,children:a})};function t(){let a=(0,d.useRouter)(),g=(0,d.useSearchParams)(),t=g?.get("id")||"",u=(0,c.useRef)(null),[v,w]=(0,c.useState)(!0),[x,y]=(0,c.useState)(!1),[z,A]=(0,c.useState)(null),[B,C]=(0,c.useState)(null),[D,E]=(0,c.useState)(null),[F,G]=(0,c.useState)(null),[H,I]=(0,c.useState)(""),[J,K]=(0,c.useState)(!0),[L,M]=(0,c.useState)(!1),[N,O]=(0,c.useState)(100),[P,Q]=(0,c.useState)({}),[R,S]=(0,c.useState)(!1),T=B?.analysis||{},U=T?.analysis_summary||{},V=async()=>{if(t){A(null),w(!0);try{let a=new f.ApiClient,b=await a.getReviewContractById(t);if(!b.success)throw Error(b.error||"Failed to load");C(b.data);let c=await a.getReviewContractUrl(t);if(c.success){let a=c.data?.url;E(a||null),G(null);let d=(b.data?.file_type||"").toLowerCase();if(a&&"txt"===d){let b=await fetch(a).then(a=>a.text());G(b)}}}catch(a){A(a instanceof Error?a.message:"Failed to load")}finally{w(!1)}}};(0,c.useEffect)(()=>{if(!t){w(!1),A("Missing review id");return}V()},[t]),(0,c.useEffect)(()=>{let a=a=>{if(!L)return;let b=u.current;b&&a.target instanceof Node&&!b.contains(a.target)&&M(!1)};return window.addEventListener("mousedown",a),()=>window.removeEventListener("mousedown",a)},[L]);let W=async a=>{if(B){A(null),y(!0);try{let b=new f.ApiClient,c="txt"===a?await b.downloadReviewReportTxt(B.id):await b.downloadReviewReportPdf(B.id);if(!c.success||!c.data)throw Error(c.error||"Download failed");let d=c.data,e=window.URL.createObjectURL(d),g=document.createElement("a");g.href=e;let h=(B.title||B.original_filename||"lawflow_report").trim().replace(/\s+/g,"_");g.download="txt"===a?`${h}_review.txt`:`${h}_review.pdf`,document.body.appendChild(g),g.click(),g.remove(),window.URL.revokeObjectURL(e)}catch(a){A(a instanceof Error?a.message:"Download failed")}finally{y(!1)}}},X=()=>{D&&window.open(D,"_blank","noopener,noreferrer")},Y=String(T?.summary||"").trim(),Z=q(T?.parties),$=q(T?.dates),_=q(T?.values),aa=q(T?.obligations),ab=q(T?.constraints),ac=q(T?.clauses),ad=q(T?.insights),ae=q(T?.suggestions),af=String(T?.jurisdiction||"").trim(),ag=H.trim().toLowerCase(),ah=(a,d)=>{let e=String(a||""),f=String(d||"").trim();if(!e||!f)return e;try{let a=f.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),d=RegExp(a,"ig"),g=e.split(d),h=e.match(d)||[];if(g.length<=1)return e;let i=[];for(let a=0;a<g.length;a++){g[a]&&i.push((0,b.jsx)(c.default.Fragment,{children:g[a]},`p-${a}`));let d=h[a];d&&i.push((0,b.jsx)("span",{className:"rounded bg-yellow-100 px-1 text-slate-900",children:d},`m-${a}`))}return i}catch{return e}},ai=(0,c.useMemo)(()=>ag?ac.filter(a=>{let b=String(a?.category||"").toLowerCase(),c=String(a?.snippet||"").toLowerCase(),d=String(a?.risk||"").toLowerCase();return String(a?.title||a?.matched_library?.title||"").toLowerCase(),String(a?.recommendation||a?.recommended_text||a?.suggested_text||a?.ai_suggestion||a?.suggestion||"").toLowerCase(),b.includes(ag)||c.includes(ag)||d.includes(ag)}):ac,[ac,ag]),aj=(0,c.useMemo)(()=>ag?ae.filter(a=>`${a?.title||""} ${a?.text||""}`.toLowerCase().includes(ag)):ae,[ae,ag]),ak=a=>{if(!a)return"";let b=a?.amount??a?.value??"",c=a?.currency??"",d=String(b).trim();return d?c?`${d} ${String(c).toUpperCase()}`:d:""},al=(0,c.useMemo)(()=>Z.map(a=>String(a?.name||"").trim()).filter(Boolean).slice(0,3).join(", "),[Z]),am=(0,c.useMemo)(()=>{let a=$.find(a=>String(a?.type||"").toLowerCase().includes("effective"));return a?.value||""},[$]),an=(0,c.useMemo)(()=>{let a=$.find(a=>String(a?.type||"").toLowerCase().includes("end"));return a?.value||""},[$]),ao=(0,c.useMemo)(()=>ak(_[0]),[_]);(0,c.useMemo)(()=>ag?Z.filter(a=>String(a?.name||"").toLowerCase().includes(ag)):Z,[Z,ag]),(0,c.useMemo)(()=>ag?$.filter(a=>{let b=r(a);return`${b.label} ${b.value}`.toLowerCase().includes(ag)}):$,[$,ag]),(0,c.useMemo)(()=>ag?_.filter(a=>JSON.stringify(a||"").toLowerCase().includes(ag)):_,[_,ag]);let ap=(a,b)=>{let c=String(a||"").trim();return c?c.length<=b?c:`${c.slice(0,b).trim()}…`:""},aq=()=>{if(!B)return"";let a=(B.original_filename||B.title||"Contract Review").trim(),b=new Date,c=String(U?.risk_level||"MEDIUM").toUpperCase(),d=Number(U?.risk_score||0),e=Z.map(a=>String(a?.name||"").trim()).filter(Boolean),f=$.map(a=>{let b=r(a);return b.value?`${b.label}: ${b.value}`:""}).filter(Boolean),g=_.map(a=>{let b=ak(a),c=String(a?.label||a?.name||"Value").trim();return b?`${c}: ${b}`:""}).filter(Boolean),h=ac.map((a,b)=>{let c=String(a?.category||"Clause"),d=String(a?.title||a?.matched_library?.title||c),e="number"==typeof a?.match_percent?a.match_percent:null,f=av(a?.match_percent),g=String(a?.snippet||a?.extracted_text||a?.text||"").trim(),h=String(au(a)||"").trim(),i="emerald"===f.tone?"#16a34a":"amber"===f.tone?"#f59e0b":"rose"===f.tone?"#e11d48":"#64748b";return`
        <div class="card" style="margin-top:12px">
          <div class="row" style="justify-content:space-between; align-items:flex-start; gap:12px">
            <div>
              <div class="h3">${ar(d)}</div>
              <div class="muted" style="font-weight:700; font-size:11px; margin-top:4px">${ar(c)}</div>
            </div>
            <div class="row" style="gap:8px; flex-wrap:wrap; justify-content:flex-end">
              <span class="badge" style="border-color:${i}; color:${i}">${ar(f.label)}</span>
              <span class="badge" style="border-color:#cbd5e1; color:#0f172a">${null!=e?`${e}%`:"—"}</span>
            </div>
          </div>
          <div class="grid2" style="margin-top:10px">
            <div class="mini">
              <div class="k">EXTRACTED TEXT</div>
              <div class="v">${ar(g||"—")}</div>
            </div>
            <div class="mini" style="border-color:#fecdd3; background:#fff1f2">
              <div class="k" style="color:#e11d48">RECOMMENDATION</div>
              <div class="v">${ar(h||"—")}</div>
            </div>
          </div>
        </div>
      `}),i=ae.slice(0,12).map(a=>{let b=String(a?.title||"Suggestion"),c=String(a?.text||"").trim();return`
        <div class="card" style="margin-top:12px; border-color:#ffe4e6; background:#fff1f2">
          <div class="h3">${ar(b)}</div>
          <div class="v" style="margin-top:8px">${ar(c||"—")}</div>
        </div>
      `});return`
<!doctype html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>${ar(a)} - Review Report</title>
    <style>
      :root { --ink:#0f172a; --muted:#64748b; --line:#e2e8f0; --bg:#ffffff; --soft:#f8fafc; --brand:#ff5aa0; }
      @page { margin: 18mm; }
      * { box-sizing: border-box; }
      body { margin:0; font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji", "Segoe UI Emoji"; color:var(--ink); background: var(--soft); }
      .wrap { max-width: 980px; margin: 0 auto; padding: 28px 18px; }
      .top { background: var(--bg); border:1px solid var(--line); border-radius: 18px; padding: 18px; }
      .row { display:flex; }
      .col { display:flex; flex-direction:column; }
      .muted { color: var(--muted); }
      .h1 { font-size: 22px; font-weight: 900; letter-spacing: -0.02em; }
      .h2 { font-size: 14px; font-weight: 900; margin:0; }
      .h3 { font-size: 13px; font-weight: 800; }
      .badge { display:inline-flex; align-items:center; padding:6px 10px; border-radius:999px; border:1px solid var(--line); font-size:12px; font-weight:800; background:#fff; }
      .grid4 { display:grid; grid-template-columns: repeat(4, minmax(0, 1fr)); gap:10px; margin-top: 14px; }
      .tile { border:1px solid var(--line); border-radius: 16px; padding: 12px; background: #fff; }
      .k { font-size: 10px; font-weight: 800; letter-spacing: 0.08em; color: var(--muted); }
      .v { font-size: 12px; line-height: 1.5; white-space: pre-wrap; }
      .tile .vBig { font-size: 16px; font-weight: 900; margin-top: 6px; }
      .section { margin-top: 14px; }
      .card { border:1px solid var(--line); border-radius: 18px; padding: 14px; background: #fff; }
      .grid2 { display:grid; grid-template-columns: 1fr 1fr; gap: 10px; }
      .mini { border:1px solid var(--line); border-radius: 14px; padding: 10px; background:#fff; }
      .hr { height:1px; background: var(--line); margin: 14px 0; }
      @media print { body { background: #fff; } .wrap { padding:0; } }
      @media (max-width: 820px) { .grid4 { grid-template-columns: repeat(2, minmax(0,1fr)); } .grid2 { grid-template-columns: 1fr; } }
    </style>
  </head>
  <body>
    <div class="wrap">
      <div class="top">
        <div class="row" style="justify-content:space-between; align-items:flex-start; gap:12px; flex-wrap:wrap">
          <div class="col" style="min-width:260px">
            <div class="h1">${ar(a)}</div>
            <div class="muted" style="margin-top:6px; font-size:12px">Generated ${b.toLocaleString()}</div>
          </div>
          <div class="row" style="gap:10px; flex-wrap:wrap; justify-content:flex-end">
            <span class="badge" style="border-color:#fda4af; color:#e11d48">${ar(String(B.status||"").toUpperCase())}</span>
            <span class="badge" style="border-color:#fecdd3; color:#e11d48">${ar(c)} RISK (${d}/100)</span>
          </div>
        </div>

        <div class="grid4">
          <div class="tile"><div class="k">TOTAL CLAUSES</div><div class="vBig">${ar(String(Number(U?.clauses_count||ac.length||0)))}</div></div>
          <div class="tile"><div class="k">AMOUNT</div><div class="vBig">${ar(ao||"—")}</div></div>
          <div class="tile"><div class="k">PARTIES</div><div class="vBig">${ar(al||(e.length?`${e.length} parties`:"—"))}</div></div>
          <div class="tile"><div class="k">DATE</div><div class="vBig">${ar(String(am||($[0]?.value?String($[0].value):"—")))}</div></div>
        </div>

        <div class="section">
          <div class="hr"></div>
          <div class="row" style="gap:10px; flex-wrap:wrap">
            ${af?`<span class="badge">Jurisdiction: ${ar(af)}</span>`:""}
            ${an?`<span class="badge">Expiry: ${ar(String(an))}</span>`:""}
          </div>
        </div>
      </div>

      <div class="section">
        <div class="card">
          <div class="h2">Summary</div>
          <div class="v" style="margin-top:10px">${ar(Y||"—")}</div>
        </div>
      </div>

      ${e.length||f.length||g.length?`
      <div class="section">
        <div class="card">
          <div class="h2">Extracted Data</div>
          <div class="grid2" style="margin-top:12px">
            <div class="mini"><div class="k">PARTIES</div><div class="v" style="margin-top:8px">${ar(e.join("\n")||"—")}</div></div>
            <div class="mini"><div class="k">DATES & VALUES</div><div class="v" style="margin-top:8px">${ar([...f,...g].join("\n")||"—")}</div></div>
          </div>
        </div>
      </div>
      `:""}

      <div class="section">
        <div class="card">
          <div class="h2">Detected Clauses</div>
          ${h.join("")}
        </div>
      </div>

      <div class="section">
        <div class="card">
          <div class="h2">Suggestions</div>
          ${i.join("")||'<div class="v" style="margin-top:10px">—</div>'}
        </div>
      </div>

      <div class="section">
        <div class="card">
          <div class="h2">Review Notes</div>
          <div class="v" style="margin-top:10px">${ar(String(B.review_text||"—"))}</div>
        </div>
      </div>
    </div>
  </body>
</html>`},ar=a=>String(a||"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;"),as=()=>{if(!B)return;let a=aq(),b=window.open("","_blank","noopener,noreferrer");b?(b.document.open(),b.document.write(a),b.document.close(),b.focus(),setTimeout(()=>{try{b.print()}catch{}},300)):A("Popup blocked. Allow popups to print the report.")},at=async a=>{let b=String(a||"").trim();if(b)try{await navigator.clipboard.writeText(b)}catch{let a=document.createElement("textarea");a.value=b,a.setAttribute("readonly","true"),a.style.position="absolute",a.style.left="-9999px",document.body.appendChild(a),a.select(),document.execCommand("copy"),a.remove()}},au=a=>{let b=a?.recommendation||a?.recommended_text||a?.suggested_text||a?.ai_suggestion||a?.suggestion;if(b)return String(b);let c=String(a?.category||"").toLowerCase(),d=String(a?.title||a?.matched_library?.title||"").toLowerCase(),e=ae.find(a=>{let b=`${a?.title||""} ${a?.text||""}`.toLowerCase();return c&&b.includes(c)||d&&b.includes(d)}),f=String(e?.text||e?.recommendation||"").trim();if(f)return f;let g=a?.matched_library;return String(g?.suggested_text||g?.recommended_text||g?.text||"").trim()},av=a=>{let b="number"==typeof a?a:Number(a);return Number.isFinite(b)?b>=85?{label:"MATCH",tone:"emerald"}:b>=60?{label:"PARTIAL MATCH",tone:"amber"}:{label:"LOW MATCH",tone:"rose"}:{label:"MATCH",tone:"slate"}},aw=B?.status==="ready",ax=(0,c.useMemo)(()=>Y||Z.length||$.length||_.length||aa.length||ac.length||ad.length||ae.length,[Y,Z.length,$.length,_.length,aa.length,ac.length,ad.length,ae.length]);return(0,b.jsx)(e.default,{children:(0,b.jsxs)("div",{className:"space-y-6 anim-fade-in",children:[(0,b.jsx)("div",{className:"flex items-start justify-between gap-4 flex-wrap",children:(0,b.jsxs)("div",{className:"min-w-0",children:[(0,b.jsxs)("button",{type:"button",onClick:()=>a.push("/review"),className:"inline-flex items-center gap-2 text-sm font-semibold text-slate-600 hover:text-slate-900",children:[(0,b.jsx)(h,{className:"w-4 h-4"}),"Back"]}),(0,b.jsxs)("h1",{className:"mt-3 text-2xl md:text-3xl font-extrabold text-slate-900 truncate",children:["Contract",(0,b.jsx)("br",{className:"md:hidden"})," Validation"]})]})}),z&&(0,b.jsx)("div",{className:"bg-rose-50 border border-rose-200 text-rose-700 rounded-2xl p-4 text-sm",children:z}),v?(0,b.jsx)("div",{className:"bg-white rounded-3xl border border-slate-200 p-10 text-slate-500",children:"Loading…"}):B?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)("div",{className:"bg-white rounded-[28px] border border-slate-200 px-4 py-3 md:px-6 md:py-4 flex items-center gap-3 flex-wrap anim-fade-up",children:[(0,b.jsxs)("div",{className:"flex items-center gap-3 min-w-0 flex-1",children:[(0,b.jsxs)("div",{className:"inline-flex items-center gap-2 px-3 py-2 rounded-2xl bg-slate-50 border border-slate-200 min-w-0",children:[(0,b.jsx)(l.FileText,{className:"w-4 h-4 text-rose-500"}),(0,b.jsx)("span",{className:"text-sm font-semibold text-slate-900 truncate",children:B.original_filename||B.title}),B.file_type?(0,b.jsxs)("span",{className:"text-[11px] font-bold text-slate-500",children:[".",String(B.file_type).toLowerCase()]}):null]}),(0,b.jsxs)("div",{className:"relative flex-1 min-w-[180px]",children:[(0,b.jsx)(o.Search,{className:"w-4 h-4 text-slate-400 absolute left-4 top-1/2 -translate-y-1/2"}),(0,b.jsx)("input",{value:H,onChange:a=>I(a.target.value),placeholder:"Search extraction…",className:"w-full bg-white border border-slate-200 rounded-full pl-10 pr-4 py-3 text-sm text-slate-800 placeholder:text-slate-400 focus:outline-none focus:ring-2 focus:ring-rose-200"}),H.trim()?(0,b.jsx)("button",{type:"button",onClick:()=>I(""),className:"absolute right-3 top-1/2 -translate-y-1/2 text-xs font-extrabold text-slate-500 hover:text-slate-800","aria-label":"Clear search",title:"Clear",children:"Clear"}):null]})]}),(0,b.jsxs)("div",{className:"flex items-center gap-2 ml-auto",children:[B.status&&(0,b.jsx)("span",{className:`hidden md:inline-flex items-center px-3 py-1 rounded-full text-xs font-semibold border ${{uploaded:"bg-slate-50 text-slate-700 border-slate-200",processing:"bg-amber-50 text-amber-700 border-amber-200",ready:"bg-emerald-50 text-emerald-700 border-emerald-200",failed:"bg-rose-50 text-rose-700 border-rose-200"}[B.status]||"bg-slate-50 text-slate-700 border-slate-200"}`,children:String(B.status).toUpperCase()}),(0,b.jsxs)("div",{className:"relative",ref:u,children:[(0,b.jsxs)("button",{type:"button",onClick:()=>M(a=>!a),className:"inline-flex items-center gap-2 rounded-full bg-[#0F141F] text-white px-4 py-2 text-sm font-semibold hover:bg-[#0F141F]/90",disabled:x||v,children:[(0,b.jsx)(j.Download,{className:"w-4 h-4"}),"Download",(0,b.jsx)(i.ChevronDown,{className:"w-4 h-4"})]}),L&&(0,b.jsxs)("div",{className:"absolute right-0 mt-2 w-52 rounded-2xl border border-slate-200 bg-white shadow-lg overflow-hidden z-20 anim-slide-down",children:[(0,b.jsx)("button",{type:"button",className:"w-full text-left px-4 py-3 text-sm hover:bg-slate-50",onClick:()=>{M(!1),(()=>{if(!B)return;let a=new Blob([aq()],{type:"text/html;charset=utf-8"}),b=window.URL.createObjectURL(a),c=document.createElement("a");c.href=b;let d=(B.title||B.original_filename||"lawflow_report").trim().replace(/\s+/g,"_");c.download=`${d}_styled_report.html`,document.body.appendChild(c),c.click(),c.remove(),window.URL.revokeObjectURL(b)})()},children:"Styled report (HTML)"}),(0,b.jsx)("button",{type:"button",className:"w-full text-left px-4 py-3 text-sm hover:bg-slate-50",onClick:()=>{M(!1),as()},children:"Styled report (Print/PDF)"}),(0,b.jsx)("div",{className:"h-px bg-slate-100"}),(0,b.jsx)("button",{type:"button",className:"w-full text-left px-4 py-3 text-sm hover:bg-slate-50",onClick:()=>{M(!1),W("pdf")},children:"Report (PDF) – basic"}),(0,b.jsx)("button",{type:"button",className:"w-full text-left px-4 py-3 text-sm hover:bg-slate-50",onClick:()=>{M(!1),W("txt")},children:"Report (TXT) – basic"}),(0,b.jsx)("button",{type:"button",className:"w-full text-left px-4 py-3 text-sm hover:bg-slate-50",onClick:()=>{M(!1),X()},disabled:!D,children:"Original file"})]})]}),(0,b.jsx)("button",{type:"button",onClick:X,className:"hidden md:inline-flex items-center justify-center w-11 h-11 rounded-full bg-white border border-slate-200","aria-label":"Open original",disabled:!D,title:"Open original",children:(0,b.jsx)(k.Eye,{className:"w-5 h-5 text-slate-700"})})]})]}),(0,b.jsxs)("div",{className:"lg:hidden flex items-center gap-2",children:[(0,b.jsxs)("button",{type:"button",onClick:()=>K(a=>!a),className:"inline-flex items-center gap-2 rounded-full bg-white border border-slate-200 px-4 py-2 text-sm font-semibold text-slate-800 hover:bg-slate-50",children:["Extracted Data",(0,b.jsx)(i.ChevronDown,{className:`w-4 h-4 transition ${J?"rotate-180":"rotate-0"}`})]}),aw&&(0,b.jsx)(s,{tone:"emerald",children:"Analyzed"})]}),(0,b.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-[minmax(480px,45%),1fr] xl:grid-cols-[minmax(540px,46%),1fr] gap-6",children:[(0,b.jsx)("div",{className:`${J?"block":"hidden"} lg:block lg:sticky lg:top-6 lg:self-start anim-fade-up`,children:(0,b.jsxs)("div",{className:"bg-white rounded-[28px] border border-slate-200 p-6 shadow-sm max-h-[calc(100vh-140px)] overflow-auto",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"font-extrabold text-slate-900",children:"Analysis & Clauses"}),(0,b.jsx)("div",{className:"text-xs text-slate-500 mt-1",children:"AI review + clause matching"})]}),(0,b.jsx)("button",{type:"button",onClick:()=>as(),className:"text-xs font-bold text-rose-600 hover:text-rose-700",disabled:x||v,title:"Export styled report",children:"Export Report"})]}),ag?(0,b.jsxs)("div",{className:"mt-3 rounded-2xl border border-slate-200 bg-slate-50 px-4 py-3 text-xs text-slate-700",children:["Showing ",(0,b.jsx)("span",{className:"font-extrabold",children:ai.length})," clauses and"," ",(0,b.jsx)("span",{className:"font-extrabold",children:aj.length})," suggestions for “",H.trim(),"”."]}):null,(0,b.jsxs)("div",{className:"mt-4 rounded-3xl bg-slate-50 border border-slate-200 p-4",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between gap-3",children:[(0,b.jsx)("div",{className:"text-sm font-extrabold text-slate-900",children:"Analysis Summary"}),(0,b.jsxs)(s,{tone:"HIGH"===String(U?.risk_level||"").toUpperCase()?"rose":"MEDIUM"===String(U?.risk_level||"").toUpperCase()?"amber":"emerald",children:[String(U?.risk_level||"MEDIUM").toUpperCase()," RISK"]})]}),(0,b.jsx)("div",{className:"mt-4 grid grid-cols-3 gap-2",children:[{label:"CLAUSES",value:Number(U?.clauses_count||ac.length||0)},{label:"OBLIGATIONS",value:Number(U?.obligations_count||aa.length||0)},{label:"CONSTRAINTS",value:Number(U?.constraints_count||ab.length||0)}].map(a=>(0,b.jsxs)("div",{className:"rounded-2xl bg-white border border-slate-200 p-3 text-center",children:[(0,b.jsx)("div",{className:"text-lg font-extrabold text-slate-900",children:a.value}),(0,b.jsx)("div",{className:"text-[10px] font-bold text-slate-500 mt-1",children:a.label})]},a.label))})]}),(0,b.jsx)("div",{className:"mt-4 grid grid-cols-2 gap-3",children:[{label:"TOTAL CLAUSES",value:String(Number(U?.clauses_count||ac.length||0))},{label:"AMOUNT",value:ao||"—"},{label:"PARTIES",value:al||(Z.length?`${String(Z.length)} parties`:"—")},{label:"DATE",value:am||($[0]?.value?String($[0].value):"—")}].map(a=>(0,b.jsxs)("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",title:a.value,children:[(0,b.jsx)("div",{className:"text-[10px] font-bold text-slate-500 tracking-wide",children:a.label}),(0,b.jsx)("div",{className:"mt-2 text-lg font-extrabold text-slate-900 truncate",children:a.value})]},a.label))}),!aw&&(0,b.jsxs)("div",{className:"mt-4 rounded-2xl bg-amber-50 border border-amber-200 p-4",children:[(0,b.jsx)("div",{className:"text-sm font-semibold text-amber-900",children:"Analysis pending"}),(0,b.jsx)("div",{className:"text-xs text-amber-800 mt-1",children:"Processing may take a moment."})]}),"failed"===B.status&&(0,b.jsxs)("div",{className:"mt-4 rounded-2xl bg-rose-50 border border-rose-200 p-4",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2 text-sm font-semibold text-rose-800",children:[(0,b.jsx)(p,{className:"w-4 h-4"}),"Review failed"]}),(0,b.jsx)("div",{className:"text-xs text-rose-700 mt-2 whitespace-pre-wrap",children:B.error_message||"Unknown error"})]}),(0,b.jsxs)("div",{className:"mt-6",children:[(0,b.jsx)("div",{className:"text-[11px] font-bold text-slate-500",children:"EXTRACTED DATA"}),(0,b.jsxs)("div",{className:"mt-3 flex flex-col gap-2",children:[al?(0,b.jsxs)(s,{tone:"violet",children:["Parties: ",al]}):null,am?(0,b.jsxs)(s,{tone:"amber",children:["Eff: ",String(am)]}):null,an?(0,b.jsxs)(s,{tone:"rose",children:["Exp: ",String(an)]}):null,ao?(0,b.jsxs)(s,{tone:"emerald",children:["Value: ",ao]}):null,af?(0,b.jsxs)(s,{tone:"violet",children:["Jurisdiction: ",af]}):null,al||am||an||ao||af?null:(0,b.jsx)("span",{className:"text-sm text-slate-500",children:"—"})]})]}),(0,b.jsxs)("div",{className:"mt-6",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsx)("div",{className:"text-[11px] font-bold text-slate-500",children:"DETECTED CLAUSES"}),(0,b.jsxs)(s,{tone:"slate",children:[ai.length," found"]})]}),(0,b.jsx)("div",{className:"mt-2 text-[11px] text-slate-500",children:"Match indicates similarity vs your clause library."}),(0,b.jsx)("div",{className:"mt-3 space-y-3",children:0===ai.length?(0,b.jsx)("div",{className:"text-sm text-slate-500",children:"—"}):(R?ai:ai.slice(0,12)).map((a,c)=>{let d=String(a?.category||"Clause"),e=String(a?.title||a?.matched_library?.title||d),f=String(a?.snippet||"").trim(),g="number"==typeof a?.match_percent?a.match_percent:null,h=av(a?.match_percent),i=au(a),j=String(a?.id||`${d}:${e}:${c}`),k=!!P[j],l=f||String(a?.extracted_text||a?.text||"").trim(),m=ap(l,260),n=ap(i||"",260),o=!!ag&&(l.toLowerCase().includes(ag)||String(i||"").toLowerCase().includes(ag)),p=k||o,q=l&&m&&l!==m||i&&n&&String(i).trim()!==n;return(0,b.jsxs)("div",{className:"rounded-3xl border border-slate-200 bg-white p-4 transition hover:bg-slate-50",children:[(0,b.jsxs)("div",{className:"flex items-start justify-between gap-3",children:[(0,b.jsxs)("div",{className:"min-w-0",children:[(0,b.jsx)("div",{className:"font-semibold text-slate-900 truncate",children:e}),(0,b.jsx)("div",{className:"text-[11px] font-bold text-slate-500 truncate",children:d})]}),(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(s,{tone:h.tone,children:h.label}),(0,b.jsx)(s,{tone:"slate",children:null!=g?`${g}%`:"—"})]})]}),(0,b.jsxs)("div",{className:"mt-3 grid grid-cols-1 xl:grid-cols-2 gap-3",children:[(0,b.jsxs)("div",{className:"rounded-2xl border border-slate-200 bg-white p-3",children:[(0,b.jsx)("div",{className:"text-[10px] font-bold tracking-wide text-slate-500",children:"EXTRACTED TEXT"}),(0,b.jsx)("div",{className:"mt-2 text-xs text-slate-700 whitespace-pre-wrap",children:p?ah(l||"—",H):ah(m||"—",H)})]}),(0,b.jsxs)("div",{className:"rounded-2xl border border-rose-200 bg-rose-50/30 p-3",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between gap-2",children:[(0,b.jsx)("div",{className:"text-[10px] font-bold tracking-wide text-rose-600",children:"RECOMMENDATION"}),i?(0,b.jsx)("button",{type:"button",className:"text-[10px] font-extrabold text-slate-600 hover:text-slate-900",onClick:async()=>{await at(String(i))},title:"Copy recommendation",children:"Copy"}):null]}),(0,b.jsx)("div",{className:"mt-2 text-xs text-slate-800 whitespace-pre-wrap",children:p?ah(i||"—",H):ah(n||"—",H)})]})]}),(0,b.jsxs)("div",{className:"mt-3 flex items-center justify-between gap-3 flex-wrap",children:[(0,b.jsx)("div",{className:"text-[11px] font-bold text-slate-400",children:" "}),(0,b.jsx)("div",{className:"flex items-center gap-2",children:q?(0,b.jsx)("button",{type:"button",className:"rounded-full bg-white border border-slate-200 text-slate-700 px-4 py-2 text-xs font-extrabold hover:bg-slate-50",onClick:()=>Q(a=>({...a,[j]:!a[j]})),children:k?"Show less":"Show more"}):null})]})]},j)})}),ai.length>12&&(0,b.jsx)("div",{className:"mt-3",children:(0,b.jsx)("button",{type:"button",className:"w-full rounded-2xl border border-slate-200 bg-white px-4 py-3 text-sm font-semibold text-slate-800 hover:bg-slate-50",onClick:()=>S(a=>!a),children:R?"Show fewer clauses":`Show all clauses (${ai.length})`})})]}),(0,b.jsxs)("div",{className:"mt-6",children:[(0,b.jsx)("div",{className:"text-[11px] font-bold text-slate-500",children:"SUMMARY"}),(0,b.jsx)("div",{className:"mt-3 text-sm text-slate-700 whitespace-pre-wrap",children:Y||"—"})]}),(0,b.jsxs)("div",{className:"mt-6",children:[(0,b.jsx)("div",{className:"text-[11px] font-bold text-slate-500",children:"SUGGESTIONS"}),(0,b.jsx)("div",{className:"mt-3 space-y-3",children:0===aj.length?(0,b.jsx)("div",{className:"text-sm text-slate-500",children:"—"}):aj.slice(0,8).map((a,c)=>(0,b.jsxs)("div",{className:"rounded-3xl border border-rose-100 bg-rose-50/40 p-4",children:[(0,b.jsx)("div",{className:"text-sm font-semibold text-slate-900",children:a?.title||"Suggestion"}),(0,b.jsx)("div",{className:"text-xs text-slate-700 mt-2 whitespace-pre-wrap",children:ah(String(a?.text||""),H)})]},c))})]})]})}),(0,b.jsxs)("div",{className:"space-y-6 anim-fade-up",id:"document-preview",children:[(0,b.jsxs)("div",{className:"bg-white rounded-[28px] border border-slate-200 overflow-hidden",children:[(0,b.jsxs)("div",{className:"px-4 py-3 md:px-6 md:py-4 border-b border-slate-200 flex items-center justify-between gap-3 flex-wrap",children:[(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsx)("div",{className:"font-extrabold text-slate-900",children:"Document Preview"}),(0,b.jsx)("div",{className:"text-xs text-slate-500",children:B.file_type?.toLowerCase()==="pdf"?"PDF":"Document"})]}),(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)("button",{type:"button",className:"w-10 h-10 rounded-full bg-white border border-slate-200 inline-flex items-center justify-center",onClick:()=>O(a=>Math.max(50,a-10)),"aria-label":"Zoom out",children:(0,b.jsx)(m.Minus,{className:"w-4 h-4 text-slate-700"})}),(0,b.jsxs)("div",{className:"text-xs font-bold text-slate-600 w-14 text-center",children:[N,"%"]}),(0,b.jsx)("button",{type:"button",className:"w-10 h-10 rounded-full bg-white border border-slate-200 inline-flex items-center justify-center",onClick:()=>O(a=>Math.min(150,a+10)),"aria-label":"Zoom in",children:(0,b.jsx)(n.Plus,{className:"w-4 h-4 text-slate-700"})})]})]}),(0,b.jsxs)("div",{className:"p-4 md:p-6",children:[D?null!=F?(0,b.jsx)("pre",{className:"whitespace-pre-wrap text-sm text-slate-800 bg-slate-50 border border-slate-200 rounded-2xl p-4 max-h-[70vh] overflow-auto",children:F}):"pdf"===(B.file_type||"").toLowerCase()?(0,b.jsx)("div",{className:"rounded-2xl border border-slate-200 overflow-hidden bg-slate-50",children:(0,b.jsx)("div",{className:"origin-top-left",style:{transform:`scale(${N/100})`,width:`${100/(N/100)}%`},children:(0,b.jsx)("iframe",{src:D,className:"w-full h-[72vh]",title:"Original Document"})})}):(0,b.jsx)("div",{className:"text-sm text-slate-700",children:"Preview isn’t available for this file type. Use “Original file” from Download."}):(0,b.jsx)("div",{className:"text-sm text-slate-500",children:"No preview URL available."}),(0,b.jsxs)("div",{className:"mt-4 flex items-center justify-between gap-3 flex-wrap",children:[(0,b.jsx)("div",{className:"text-xs text-slate-500",children:Y?"Summary available":"No summary available yet"}),aw?(0,b.jsx)(s,{tone:"emerald",children:"Analyzed"}):(0,b.jsx)(s,{tone:"amber",children:"AI Analysis Pending"})]})]})]}),(0,b.jsxs)("div",{className:"bg-white rounded-[28px] border border-slate-200 p-6",children:[(0,b.jsx)("div",{className:"font-extrabold text-slate-900",children:"Review Notes (Editor)"}),(0,b.jsx)("div",{className:"text-xs text-slate-500 mt-1",children:"Read-only view of the AI reviewer output"}),(0,b.jsx)("div",{className:"mt-4 rounded-2xl border border-slate-200 bg-slate-50 p-4",children:(0,b.jsx)("div",{className:"text-sm text-slate-800 whitespace-pre-wrap",children:B.review_text?.trim()?B.review_text:"—"})}),!ax&&(0,b.jsx)("div",{className:"mt-4 text-sm text-slate-600",children:"No structured extraction found yet. Upload a clearer PDF/DOCX and try again."})]})]})]})]}):(0,b.jsx)("div",{className:"bg-white rounded-3xl border border-slate-200 p-10 text-slate-500",children:"Not found"})]})})}a.s(["default",()=>t],85841)}];

//# sourceMappingURL=app_review_detail_ReviewDetailClient_tsx_b4a655ce._.js.map