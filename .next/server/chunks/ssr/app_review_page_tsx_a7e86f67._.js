module.exports=[43188,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(50944),e=a.i(52072),f=a.i(98448),g=a.i(84505),h=a.i(77156),i=a.i(4720);let j=(0,a.i(70106).default)("refresh-ccw",[["path",{d:"M21 12a9 9 0 0 0-9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"14sxne"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M3 12a9 9 0 0 0 9 9 9.75 9.75 0 0 0 6.74-2.74L21 16",key:"1hlbsb"}],["path",{d:"M16 16h5v5",key:"ccwih5"}]]);var k=a.i(87532),l=a.i(81560),m=a.i(74618);function n(){let a,n,o=(0,d.useRouter)(),p=(0,c.useRef)(null),[q,r]=(0,c.useState)(!1),[s,t]=(0,c.useState)(!1),[u,v]=(0,c.useState)(null),[w,x]=(0,c.useState)(null),[y,z]=(0,c.useState)(!1),[A,B]=(0,c.useState)([]),[C,D]=(0,c.useState)(""),[E,F]=(0,c.useState)(!1),[G,H]=(0,c.useState)({open:!1,item:null,url:null,text:null}),I=async a=>{v(null),t(!0);try{let b=new f.ApiClient,c=await b.listReviewContracts({q:a?.trim()?a.trim():void 0});if(!c.success)throw Error(c.error||"Failed to load review contracts");let d=c.data?.results||[];B(d)}catch(a){v(a instanceof Error?a.message:"Failed to load review contracts")}finally{t(!1)}};(0,c.useEffect)(()=>{I()},[]),(0,c.useEffect)(()=>{let a=window.setTimeout(()=>{I(C)},250);return()=>window.clearTimeout(a)},[C]);let J=(0,c.useMemo)(()=>{let a=C.trim().toLowerCase();return a?A.filter(b=>{let c=(b.title||"").toLowerCase(),d=(b.original_filename||"").toLowerCase();return c.includes(a)||d.includes(a)}):A},[A,C]),K=async a=>{let b,c,d="pdf"!==(c=(b=(a.name||"").toLowerCase()).includes(".")?b.split(".").pop():"")&&"txt"!==c&&"docx"!==c?"Only .pdf, .docx and .txt files are supported.":a.size>0x1900000?"File too large. Max size is 25MB.":null;if(d)return void v(d);r(!0),x(0),z(!1),v(null);try{let b=new f.ApiClient,c=await b.uploadReviewContractWithProgress(a,{analyze:!0,onProgress:({percent:a})=>{"number"==typeof a&&x(a)}});if(!c.success)throw Error(c.error||"Upload failed");z(!0),await I(C)}catch(a){v(a instanceof Error?a.message:"Upload failed")}finally{r(!1),setTimeout(()=>{x(null),z(!1)},350)}},L=async a=>{v(null),H({open:!0,item:a,url:null,text:null});try{let b=new f.ApiClient,c=await b.getReviewContractUrl(a.id);if(!c.success)throw Error(c.error||"Failed to get preview URL");let d=c.data?.url;if(!d)throw Error("No URL returned");if("txt"===(a.file_type||"").toLowerCase()){let b=await fetch(d).then(a=>a.text());H({open:!0,item:a,url:d,text:b})}else H({open:!0,item:a,url:d,text:null})}catch(a){v(a instanceof Error?a.message:"Failed to open preview")}},M=async a=>{v(null);try{let b=new f.ApiClient,c=await b.getReviewContractUrl(a.id);if(!c.success)throw Error(c.error||"Failed to get download URL");let d=c.data?.url;if(!d)throw Error("No URL returned");window.open(d,"_blank","noopener,noreferrer")}catch(a){v(a instanceof Error?a.message:"Download failed")}},N=async(a,b)=>{v(null);try{let c=new f.ApiClient,d="txt"===b?await c.downloadReviewReportTxt(a.id):await c.downloadReviewReportPdf(a.id);if(!d.success||!d.data)throw Error(d.error||"Download failed");let e=d.data,g=window.URL.createObjectURL(e),h=document.createElement("a");h.href=g;let i=(a.title||a.original_filename||"lawflow_report").trim().replace(/\s+/g,"_");h.download="txt"===b?`${i}_review.txt`:`${i}_review.pdf`,document.body.appendChild(h),h.click(),h.remove(),window.URL.revokeObjectURL(g)}catch(a){v(a instanceof Error?a.message:"Download failed")}},O=async a=>{v(null),r(!0);try{let b=new f.ApiClient,c=await b.analyzeReviewContract(a.id);if(!c.success)throw Error(c.error||"Analyze failed");await I(C)}catch(a){v(a instanceof Error?a.message:"Analyze failed")}finally{r(!1)}},P=async a=>{if(window.confirm(`Delete ${a.title||a.original_filename}?`)){v(null),r(!0);try{let b=new f.ApiClient,c=await b.deleteReviewContract(a.id);if(!c.success)throw Error(c.error||"Delete failed");await I(C),G.item?.id===a.id&&H({open:!1,item:null,url:null,text:null})}catch(a){v(a instanceof Error?a.message:"Delete failed")}finally{r(!1)}}};return(0,b.jsx)(e.default,{children:(0,b.jsxs)("div",{className:"space-y-6 anim-fade-in",children:[(0,b.jsxs)("div",{className:"flex flex-col gap-4 md:flex-row md:items-center md:justify-between",children:[(0,b.jsxs)("h1",{className:"text-3xl md:text-3xl font-extrabold text-slate-900 leading-tight",children:["Review",(0,b.jsx)("br",{className:"md:hidden"})," Contracts"]}),(0,b.jsx)("div",{className:"flex items-center gap-3 w-full md:w-auto",children:(0,b.jsxs)("div",{className:"relative w-full md:w-[360px]",children:[(0,b.jsx)(k.Search,{className:"w-4 h-4 text-slate-400 absolute left-4 top-1/2 -translate-y-1/2"}),(0,b.jsx)("input",{value:C,onChange:a=>D(a.target.value),placeholder:"Search...",className:"w-full bg-white border border-slate-200 rounded-full pl-10 pr-4 py-3 text-sm text-slate-800 placeholder:text-slate-400 focus:outline-none focus:ring-2 focus:ring-rose-200"})]})})]}),(0,b.jsxs)("div",{className:"bg-white rounded-[28px] p-6 md:p-8 shadow-sm",children:[(0,b.jsxs)("div",{className:"text-sm font-bold text-slate-900 flex items-center gap-2 mb-3",children:[(0,b.jsx)(m.UploadCloud,{className:"w-5 h-5 text-rose-500"}),"Upload Contract for Review"]}),(0,b.jsxs)("div",{className:`relative rounded-[22px] border-2 border-dashed overflow-hidden transition-all duration-300 ease-out ${E?"border-rose-300 shadow-lg shadow-rose-100/70 scale-[1.01]":"border-rose-200"} ${q?"opacity-90":"hover:shadow-md hover:shadow-rose-100/50"}`,style:{background:"linear-gradient(180deg, rgba(255,92,122,0.85), rgba(255,92,122,0.70))"},onDragEnter:a=>{a.preventDefault(),a.stopPropagation(),F(!0)},onDragOver:a=>{a.preventDefault(),a.stopPropagation(),F(!0)},onDragLeave:a=>{a.preventDefault(),a.stopPropagation(),F(!1)},onDrop:a=>{a.preventDefault(),a.stopPropagation(),F(!1);let b=a.dataTransfer.files?.[0];b&&K(b)},children:[(0,b.jsxs)("div",{className:"absolute inset-0 pointer-events-none",children:[(0,b.jsx)("div",{className:`absolute inset-0 opacity-25 anim-shimmer transition-opacity ${E?"opacity-40":""}`,style:{background:"linear-gradient(90deg, rgba(255,255,255,0.06) 0%, rgba(255,255,255,0.18) 35%, rgba(255,255,255,0.06) 70%)"}}),(0,b.jsx)("div",{className:"absolute -top-24 -left-24 w-72 h-72 rounded-full bg-white/10 blur-3xl anim-breathe"}),(0,b.jsx)("div",{className:"absolute -bottom-24 -right-24 w-72 h-72 rounded-full bg-black/10 blur-3xl anim-breathe",style:{animationDelay:"250ms"}})]}),(0,b.jsxs)("div",{className:"px-6 py-12 md:py-14 flex flex-col items-center text-center text-white",children:[(0,b.jsxs)("div",{className:"relative mb-4",children:[(0,b.jsx)("div",{className:`absolute -inset-6 rounded-full bg-white/10 ${E?"animate-ping":"opacity-0"}`}),(0,b.jsx)("div",{className:`absolute -inset-10 rounded-full bg-white/5 ${"number"==typeof w?"animate-ping":"opacity-0"}`}),(0,b.jsx)("div",{className:`w-16 h-16 rounded-full bg-white/15 flex items-center justify-center transition-transform ${E?"scale-[1.05]":""} ${"number"==typeof w?"anim-breathe":"anim-float"}`,children:(0,b.jsx)(m.UploadCloud,{className:"w-7 h-7 text-white"})})]}),(0,b.jsx)("div",{className:"text-base md:text-lg font-extrabold",children:"Drag & Drop files here"}),(0,b.jsx)("div",{className:"text-xs md:text-sm text-white/90 mt-2",children:"Support for PDF, DOCX and .TXT files"}),(0,b.jsx)("div",{className:"text-[11px] md:text-xs text-white/80 mt-1",children:"Max file size 25MB"}),(0,b.jsx)("button",{type:"button",onClick:()=>p.current?.click(),className:"mt-6 inline-flex items-center justify-center rounded-full bg-white text-slate-900 px-5 py-2.5 text-sm font-semibold hover:bg-white/90 transition-transform duration-200 ease-out active:scale-[0.98]",disabled:q,children:"Choose file"}),(0,b.jsx)("input",{ref:p,type:"file",accept:".pdf,.txt,.docx,application/pdf,text/plain,application/vnd.openxmlformats-officedocument.wordprocessingml.document",className:"hidden",onChange:a=>{let b=a.target.files?.[0];b&&K(b),a.currentTarget.value=""}})]})]}),("number"==typeof w||y)&&(0,b.jsxs)("div",{className:"mt-4",children:["number"==typeof w&&(0,b.jsx)("div",{className:"mb-3 anim-fade-up",children:(a=Math.min(100,Math.max(0,w)),n=`calc(${a}% - 10px)`,(0,b.jsxs)("div",{className:"rounded-2xl border border-rose-200 bg-white/70 px-4 py-3 shadow-sm",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between text-xs text-slate-700",children:[(0,b.jsx)("div",{className:"font-extrabold",children:"Uploading"}),(0,b.jsxs)("div",{className:"font-extrabold tabular-nums",children:[a,"%"]})]}),(0,b.jsxs)("div",{className:"mt-2 relative h-3 rounded-full bg-slate-100 border border-slate-200 overflow-hidden",children:[(0,b.jsx)("div",{className:"absolute inset-0 opacity-50 anim-shimmer",style:{background:"linear-gradient(90deg, rgba(255,90,160,0.06) 0%, rgba(255,90,160,0.22) 35%, rgba(255,90,160,0.06) 70%)"}}),(0,b.jsx)("div",{className:"h-full rounded-full bg-gradient-to-r from-rose-500 via-fuchsia-500 to-amber-400 transition-[width] duration-200",style:{width:`${a}%`}}),(0,b.jsx)("div",{className:"absolute top-1/2 -translate-y-1/2 w-5 h-5 rounded-full bg-white/80 border border-white shadow-[0_10px_30px_rgba(244,63,94,0.25)] blur-[0.2px] animate-pulse",style:{left:n}})]}),(0,b.jsx)("div",{className:"mt-2 text-[11px] font-semibold text-slate-600",children:"Uploading & preparing AI review…"})]}))}),y&&(0,b.jsxs)("div",{children:[(0,b.jsxs)("div",{className:"flex items-center justify-between text-xs text-slate-600 mb-1",children:[(0,b.jsx)("div",{className:"font-semibold",children:"Processing"}),(0,b.jsx)("div",{children:"Analyzing…"})]}),(0,b.jsx)("div",{className:"h-2 rounded-full bg-slate-100 overflow-hidden",children:(0,b.jsx)("div",{className:"h-2 w-1/3 rounded-full bg-slate-300 anim-breathe"})})]})]}),u&&(0,b.jsx)("div",{className:"mt-4 text-sm text-rose-600",children:u})]}),(0,b.jsxs)("div",{className:"bg-white rounded-[28px] p-6 md:p-8 shadow-sm",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between gap-4 mb-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"text-lg font-extrabold text-slate-900",children:"Reviewed Documents"}),(0,b.jsxs)("div",{className:"text-sm text-slate-500",children:[J.length," item",1!==J.length?"s":""]})]}),(0,b.jsxs)("button",{type:"button",onClick:()=>I(C),className:"inline-flex items-center gap-2 rounded-full bg-white border border-slate-200 px-4 py-2 text-sm font-semibold text-slate-800 hover:bg-slate-50",disabled:s,children:[(0,b.jsx)(j,{className:"w-4 h-4"}),"Refresh"]})]}),(0,b.jsx)("div",{className:"overflow-x-auto",children:(0,b.jsxs)("table",{className:"w-full text-sm",children:[(0,b.jsx)("thead",{children:(0,b.jsxs)("tr",{className:"text-left text-slate-500",children:[(0,b.jsx)("th",{className:"py-3 pr-4",children:"Document"}),(0,b.jsx)("th",{className:"py-3 pr-4",children:"Status"}),(0,b.jsx)("th",{className:"py-3 pr-4",children:"Size"}),(0,b.jsx)("th",{className:"py-3 pr-4",children:"Created"}),(0,b.jsx)("th",{className:"py-3 pr-0 text-right",children:"Actions"})]})}),(0,b.jsx)("tbody",{className:"divide-y divide-slate-200",children:s?(0,b.jsx)("tr",{children:(0,b.jsx)("td",{className:"py-10 text-slate-500",colSpan:5,children:"Loading…"})}):0===J.length?(0,b.jsx)("tr",{children:(0,b.jsx)("td",{className:"py-10 text-slate-500",colSpan:5,children:"No review documents yet"})}):J.map((a,c)=>(0,b.jsxs)("tr",{className:"hover:bg-slate-50 anim-fade-up",style:{animationDelay:`${18*Math.min(15,c)}ms`},children:[(0,b.jsx)("td",{className:"py-4 pr-4",children:(0,b.jsxs)("button",{type:"button",onClick:()=>o.push(`/review/detail?id=${encodeURIComponent(a.id)}`),className:"text-left",children:[(0,b.jsx)("div",{className:"font-semibold text-slate-900",children:a.title||a.original_filename}),(0,b.jsx)("div",{className:"text-xs text-slate-500",children:a.original_filename})]})}),(0,b.jsx)("td",{className:"py-4 pr-4",children:(0,b.jsx)("span",{className:`inline-flex items-center px-3 py-1 rounded-full text-xs font-semibold border ${{uploaded:"bg-slate-50 text-slate-700 border-slate-200",processing:"bg-amber-50 text-amber-700 border-amber-200",ready:"bg-emerald-50 text-emerald-700 border-emerald-200",failed:"bg-rose-50 text-rose-700 border-rose-200"}[a.status]||"bg-slate-50 text-slate-700 border-slate-200"}`,children:String(a.status).toUpperCase()})}),(0,b.jsx)("td",{className:"py-4 pr-4 text-slate-700",children:(a=>{let b=Number(a||0);if(b<1024)return`${b} B`;let c=b/1024;if(c<1024)return`${c.toFixed(0)} KB`;let d=c/1024;if(d<1024)return`${d.toFixed(1)} MB`;let e=d/1024;return`${e.toFixed(1)} GB`})(a.size_bytes)}),(0,b.jsx)("td",{className:"py-4 pr-4 text-slate-700",children:(a=>{if(!a)return"—";let b=new Date(a);return Number.isNaN(b.getTime())?"—":b.toLocaleDateString(void 0,{month:"short",day:"numeric",year:"numeric"})})(a.created_at)}),(0,b.jsx)("td",{className:"py-4 pr-0",children:(0,b.jsxs)("div",{className:"flex items-center justify-end gap-2",children:[(0,b.jsx)("button",{type:"button",onClick:()=>o.push(`/review/detail?id=${encodeURIComponent(a.id)}`),className:"w-9 h-9 rounded-xl bg-slate-100 hover:bg-slate-200 inline-flex items-center justify-center",title:"Open review",children:(0,b.jsx)(i.FileText,{className:"w-4 h-4 text-slate-700"})}),(0,b.jsx)("button",{type:"button",onClick:()=>L(a),className:"w-9 h-9 rounded-xl bg-slate-100 hover:bg-slate-200 inline-flex items-center justify-center",title:"Preview",children:(0,b.jsx)(h.Eye,{className:"w-4 h-4 text-slate-700"})}),(0,b.jsx)("button",{type:"button",onClick:()=>M(a),className:"w-9 h-9 rounded-xl bg-slate-100 hover:bg-slate-200 inline-flex items-center justify-center",title:"Download original",children:(0,b.jsx)(g.Download,{className:"w-4 h-4 text-slate-700"})}),(0,b.jsx)("button",{type:"button",onClick:()=>N(a,"pdf"),className:"px-3 h-9 rounded-xl bg-[#0F141F] text-white hover:bg-[#0F141F]/90 inline-flex items-center justify-center text-xs font-semibold",title:"Download report (PDF)",children:"Report PDF"}),(0,b.jsx)("button",{type:"button",onClick:()=>N(a,"txt"),className:"px-3 h-9 rounded-xl bg-white border border-slate-200 text-slate-800 hover:bg-slate-50 inline-flex items-center justify-center text-xs font-semibold",title:"Download report (TXT)",children:"Report TXT"}),(0,b.jsx)("button",{type:"button",onClick:()=>O(a),className:"w-9 h-9 rounded-xl bg-amber-50 hover:bg-amber-100 inline-flex items-center justify-center",title:"Re-analyze",disabled:q,children:(0,b.jsx)(j,{className:"w-4 h-4 text-amber-700"})}),(0,b.jsx)("button",{type:"button",onClick:()=>P(a),className:"w-9 h-9 rounded-xl bg-rose-50 hover:bg-rose-100 inline-flex items-center justify-center",title:"Delete",disabled:q,children:(0,b.jsx)(l.Trash2,{className:"w-4 h-4 text-rose-600"})})]})})]},a.id))})]})})]}),G.open&&(0,b.jsx)("div",{className:"fixed inset-0 z-[80] bg-black/50 flex items-center justify-center p-4 anim-fade-in",children:(0,b.jsxs)("div",{className:"bg-white w-full max-w-5xl rounded-3xl overflow-hidden shadow-xl anim-scale-in",children:[(0,b.jsxs)("div",{className:"px-6 py-4 border-b border-slate-200 flex items-center justify-between",children:[(0,b.jsxs)("div",{className:"min-w-0",children:[(0,b.jsx)("div",{className:"font-extrabold text-slate-900 truncate",children:G.item?.title||G.item?.original_filename||"Preview"}),(0,b.jsx)("div",{className:"text-xs text-slate-500 truncate",children:G.item?.original_filename})]}),(0,b.jsx)("button",{type:"button",onClick:()=>H({open:!1,item:null,url:null,text:null}),className:"w-10 h-10 rounded-xl bg-slate-100 hover:bg-slate-200 inline-flex items-center justify-center","aria-label":"Close",children:"✕"})]}),(0,b.jsx)("div",{className:"p-6",children:G.url?null!=G.text?(0,b.jsx)("pre",{className:"whitespace-pre-wrap text-sm text-slate-800 bg-slate-50 border border-slate-200 rounded-2xl p-4 max-h-[70vh] overflow-auto",children:G.text}):"pdf"===(G.item?.file_type||"").toLowerCase()?(0,b.jsx)("iframe",{src:G.url,className:"w-full h-[70vh] rounded-2xl border border-slate-200",title:"Preview"}):(0,b.jsxs)("div",{className:"text-slate-700",children:["Preview isn’t available for this file type."," ",(0,b.jsx)("button",{type:"button",className:"text-rose-600 font-semibold",onClick:()=>G.item&&M(G.item),children:"Download original"}),"."]}):(0,b.jsx)("div",{className:"text-slate-500",children:"Loading preview…"})})]})})]})})}a.s(["default",()=>n],43188)}];

//# sourceMappingURL=app_review_page_tsx_a7e86f67._.js.map