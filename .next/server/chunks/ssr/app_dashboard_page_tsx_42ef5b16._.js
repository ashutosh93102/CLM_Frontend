module.exports=[20731,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(52072),e=a.i(50944),f=a.i(64440),g=a.i(98448),h=a.i(60702);let i=(0,a.i(70106).default)("clipboard-check",[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}],["path",{d:"m9 14 2 2 4-4",key:"df797q"}]]);var j=a.i(4720),k=a.i(8406),l=a.i(73320),m=a.i(67149),n=a.i(27165),o=a.i(64321),p=a.i(48662),q=a.i(59854);let r=["#0F141F","#F43F5E","#06B6D4","#A78BFA","#F59E0B","#10B981","#64748B","#E11D48"],s=()=>{let a=(0,e.useRouter)(),{user:s,isLoading:t,isAuthenticated:u}=(0,f.useAuth)(),[v,w]=(0,c.useState)({total:0,draft:0,pending:0,approved:0,rejected:0}),[x,y]=(0,c.useState)(!1),[z,A]=(0,c.useState)([]),[B,C]=(0,c.useState)([]),[D,E]=(0,c.useState)([]),[F,G]=(0,c.useState)(null),[H,I]=(0,c.useState)(!1);if((0,c.useEffect)(()=>{t||u||a.push("/")},[t,u,a]),(0,c.useEffect)(()=>{let b=async()=>{try{if(t||!u)return;y(!0),I(!0);let b=new g.ApiClient,c=new Date,d=new Date;c.setDate(c.getDate()-365),d.setDate(d.getDate()+365);let[e,f,h,i,j]=await Promise.all([b.getContractStatistics(),b.getRecentContracts(5),b.getContracts(),b.getDashboardInsights(),b.listCalendarEvents({start:c.toISOString(),end:d.toISOString()})]);if([e,f,h,i,j].some(a=>!a.success&&401===a.status)){try{b.logout()}catch{}a.push("/");return}if(e.success&&e.data&&w({total:e.data.total||0,draft:e.data.draft||0,pending:e.data.pending||0,approved:e.data.approved||0,rejected:e.data.rejected||0}),f.success&&f.data){let a=(Array.isArray(f.data)?f.data:f.data.results||[]).slice(0,5).map(a=>({id:a.id,name:a.title||a.name,status:a.status,date:a.created_at||new Date().toISOString().split("T")[0],value:a.value||0,trend:0}));A(a)}if(h.success&&h.data){let a=Array.isArray(h.data)?h.data:h.data.results||[],b=new Date,c=[];for(let a=5;a>=0;a--)c.push(new Date(b.getFullYear(),b.getMonth()-a,1));let d=c.map(b=>{let c=`${b.getFullYear()}-${String(b.getMonth()+1).padStart(2,"0")}`,d=b.toLocaleString(void 0,{month:"short"}),e=a.filter(a=>{let b=a.created_at||a.createdAt||a.date||a.created;if(!b)return!1;let d=new Date(b);return`${d.getFullYear()}-${String(d.getMonth()+1).padStart(2,"0")}`===c}).length;return{month:d,count:e}});E(d)}if(i.success&&i.data&&G(i.data),j&&j.success&&j.data){let a=j.data,b=Array.isArray(a)?a:a.results||[],c=new Date,d=b.map(a=>{let b=a.start_datetime||a.startDatetime||a.start,c=a.end_datetime||a.endDatetime||a.end,d=b?String(b):"",e=c?String(c):void 0,f=d?new Date(d):null,g=f&&!Number.isNaN(f.getTime())?f.getTime():NaN;return{id:String(a.id||""),title:String(a.title||"Untitled event"),start:d,end:e,allDay:!!(a.all_day??a.allDay),category:a.category,__startMs:g}}).filter(a=>Number.isFinite(a.__startMs)).sort((a,b)=>a.__startMs-b.__startMs),e=c.getTime(),f=d.filter(a=>{let b=a.__startMs,c=a.end?new Date(a.end).getTime():NaN,d=Number.isFinite(c);return b>=e||d&&c>=e}),g=(f.length?f:[...d].reverse()).slice(0,3).map(({__startMs:a,...b})=>b);C(g)}else C([])}catch(a){console.error("Failed to fetch data:",a)}finally{y(!1),I(!1)}};s&&!t&&u&&b()},[s,t,u,a]),t)return(0,b.jsx)("div",{className:"flex h-screen items-center justify-center bg-slate-50",children:(0,b.jsxs)("div",{className:"text-center",children:[(0,b.jsx)("div",{className:"w-12 h-12 rounded-full border-4 border-slate-200 border-t-blue-600 animate-spin mx-auto mb-4"}),(0,b.jsx)("p",{className:"text-slate-600",children:"Loading dashboard..."})]})});if(!u)return null;let J=(F?.feature_usage_30d||[]).reduce((a,b)=>a+(String(b.key||"").toLowerCase().includes("review")&&b.count||0),0),K=(F?.feature_usage_30d||[]).reduce((a,b)=>{let c=String(b.key||"").toLowerCase();return a+((c.includes("upload")||c.includes("document"))&&b.count||0)},0),L="number"==typeof F?.upload_count_30d?F.upload_count_30d:K,M="number"==typeof F?.templates_count?F.templates_count:("number"==typeof F?.template_files_count?F.template_files_count:0)+("number"==typeof F?.contract_templates_count?F.contract_templates_count:0),N=(F?.ai_tasks_by_status_180d||[]).reduce((a,b)=>a+(b.count||0),0),O=function(a,b=6){let c=[...a].sort((a,b)=>(b.value||0)-(a.value||0));if(c.length<=b)return c;let d=c.slice(0,b),e=c.slice(b).reduce((a,b)=>a+(b.value||0),0);return e<=0?d:[...d,{name:"Other",value:e}]}((F?.contract_types_180d||[]).map(a=>({name:a.type||"Unspecified",value:a.count})),4),P=Array.isArray(F?.esign_by_provider_180d)?F?.esign_by_provider_180d:[],Q=P.reduce((a,b)=>a+(b.count||0),0),R=P.reduce((a,b)=>{let c=String(b.provider||"").toLowerCase();return a+((c.includes("inhouse")||c.includes("in-house")||c.includes("in_house"))&&b.count||0)},0),S=Math.max(0,Q-R),T=Q>0?Math.round(R/Q*100):0,U="number"==typeof F?.calendar_upcoming_365d?F.calendar_upcoming_365d:F?.calendar_upcoming_30d??0;return(0,b.jsxs)(d.default,{children:[(0,b.jsx)("div",{className:"flex flex-col gap-4 md:flex-row md:items-center md:justify-between mb-7",children:(0,b.jsx)("div",{className:"flex items-center gap-4",children:(0,b.jsx)("h1",{className:"text-2xl md:text-3xl font-extrabold text-slate-900",children:"Dashboard"})})}),(0,b.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 xl:grid-cols-4 gap-5 mb-8",children:[(0,b.jsxs)("div",{className:"rounded-[28px] bg-gradient-to-br from-rose-400 to-pink-500 text-white p-6 relative overflow-hidden",children:[(0,b.jsx)("div",{className:"absolute inset-0 opacity-15",style:{backgroundImage:"radial-gradient(circle at 80% 30%, #fff 0 2px, transparent 3px)"}}),(0,b.jsx)("div",{className:"flex items-start justify-between",children:(0,b.jsx)("div",{className:"w-10 h-10 rounded-2xl bg-white/20 flex items-center justify-center",children:(0,b.jsx)(j.FileText,{className:"w-5 h-5"})})}),(0,b.jsx)("p",{className:"mt-5 text-4xl font-extrabold",children:v.total}),(0,b.jsx)("p",{className:"text-sm text-white/90",children:"Total Contracts"})]}),(0,b.jsxs)("div",{className:"rounded-[28px] bg-white/90 border border-slate-200 p-6",children:[(0,b.jsxs)("div",{className:"flex items-start justify-between",children:[(0,b.jsx)("div",{className:"w-10 h-10 rounded-2xl bg-amber-50 border border-amber-100 flex items-center justify-center",children:(0,b.jsx)(i,{className:"w-5 h-5 text-amber-600"})}),(0,b.jsx)("span",{className:"text-[11px] bg-amber-50 border border-amber-100 text-amber-700 px-2 py-1 rounded-full font-bold",children:"Metrics"})]}),(0,b.jsxs)("div",{className:"mt-5 space-y-3",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)("span",{className:"w-2 h-2 rounded-full bg-amber-400"}),(0,b.jsx)("span",{className:"text-sm font-extrabold text-slate-900",children:"Review usage"})]}),(0,b.jsx)("span",{className:"text-2xl font-extrabold text-slate-900",children:J})]}),(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2 min-w-0",children:[(0,b.jsx)("span",{className:"w-2 h-2 rounded-full bg-slate-400"}),(0,b.jsx)("span",{className:"text-sm font-extrabold text-slate-900 truncate",children:"Uploads (30d)"})]}),(0,b.jsx)("span",{className:"text-2xl font-extrabold text-slate-900",children:L})]}),(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2 min-w-0",children:[(0,b.jsx)("span",{className:"w-2 h-2 rounded-full bg-rose-400"}),(0,b.jsx)("span",{className:"text-sm font-extrabold text-slate-900 truncate",children:"Templates (active)"})]}),(0,b.jsx)("span",{className:"text-2xl font-extrabold text-slate-900",children:M})]})]}),(0,b.jsxs)("div",{className:"mt-4 flex items-center gap-2 text-xs font-semibold text-slate-500",children:[(0,b.jsx)(l.Upload,{className:"w-4 h-4"}),"Uploads include private + repository"]})]}),(0,b.jsxs)("div",{className:"rounded-[28px] bg-white/90 border border-slate-200 p-6",children:[(0,b.jsx)("div",{className:"flex items-start justify-between",children:(0,b.jsx)("div",{className:"w-10 h-10 rounded-2xl bg-violet-50 border border-violet-100 flex items-center justify-center",children:(0,b.jsx)(k.Sparkles,{className:"w-5 h-5 text-violet-600"})})}),(0,b.jsx)("p",{className:"mt-5 text-4xl font-extrabold text-slate-900",children:N.toLocaleString()}),(0,b.jsx)("p",{className:"text-sm text-slate-500",children:"AI Generations Used"})]}),(0,b.jsxs)("div",{className:"rounded-[28px] bg-white/90 border border-slate-200 p-6",children:[(0,b.jsxs)("div",{className:"flex items-start justify-between",children:[(0,b.jsx)("div",{className:"w-10 h-10 rounded-2xl bg-blue-50 border border-blue-100 flex items-center justify-center",children:(0,b.jsx)(h.CalendarDays,{className:"w-5 h-5 text-blue-600"})}),(0,b.jsx)("span",{className:"text-[11px] bg-blue-50 border border-blue-100 text-blue-700 px-2 py-1 rounded-full font-bold",children:"Next: 12mo"})]}),(0,b.jsx)("p",{className:"mt-5 text-4xl font-extrabold text-slate-900",children:U}),(0,b.jsx)("p",{className:"text-sm text-slate-500",children:"Upcoming Events"})]})]}),(0,b.jsxs)("div",{className:"grid grid-cols-1 xl:grid-cols-12 gap-6",children:[(0,b.jsxs)("div",{className:"xl:col-span-4 bg-white/90 border border-slate-200 rounded-[28px] p-6",children:[(0,b.jsx)("h2",{className:"text-lg font-extrabold text-slate-900",children:"Contract Type Distribution"}),(0,b.jsx)("div",{className:"mt-6 h-64 relative",children:O.reduce((a,b)=>a+b.value,0)>0?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(p.ResponsiveContainer,{width:"100%",height:"100%",children:(0,b.jsxs)(o.PieChart,{children:[(0,b.jsx)(n.Pie,{data:O,dataKey:"value",nameKey:"name",innerRadius:78,outerRadius:102,paddingAngle:2,isAnimationActive:!0,animationDuration:900,children:O.map((a,c)=>(0,b.jsx)(m.Cell,{fill:r[(c+1)%r.length]},`${a.name}-${c}`))}),(0,b.jsx)(q.Tooltip,{contentStyle:{borderRadius:12,border:"1px solid #E2E8F0"}})]})}),(0,b.jsxs)("div",{className:"absolute inset-0 flex flex-col items-center justify-center pointer-events-none",children:[(0,b.jsx)("div",{className:"text-3xl font-extrabold text-slate-900",children:v.total}),(0,b.jsx)("div",{className:"text-xs font-bold tracking-widest text-slate-400",children:"ACTIVE"})]})]}):(0,b.jsx)("div",{className:"h-full flex items-center justify-center text-sm text-slate-500",children:"No contract type data yet."})}),(0,b.jsx)("div",{className:"mt-4 grid grid-cols-2 gap-2",children:O.slice(0,4).map((a,c)=>(0,b.jsxs)("div",{className:"flex items-center gap-2 text-xs text-slate-600 font-semibold",children:[(0,b.jsx)("span",{className:"w-2 h-2 rounded-full",style:{backgroundColor:r[(c+1)%r.length]}}),(0,b.jsx)("span",{className:"truncate",children:a.name})]},a.name))})]}),(0,b.jsxs)("div",{className:"xl:col-span-5 bg-white/90 border border-slate-200 rounded-[28px] p-6",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsx)("h2",{className:"text-lg font-extrabold text-slate-900",children:"Recent Contracts"}),(0,b.jsx)("button",{onClick:()=>a.push("/contracts"),className:"text-sm font-semibold text-rose-500",children:"View All"})]}),(0,b.jsxs)("div",{className:"mt-5",children:[(0,b.jsxs)("div",{className:"hidden md:grid grid-cols-[1fr,140px,80px] gap-3 text-xs font-bold text-slate-400 px-3 py-2",children:[(0,b.jsx)("div",{children:"Contract Name"}),(0,b.jsx)("div",{children:"Status"}),(0,b.jsx)("div",{children:"Date"})]}),x?(0,b.jsx)("div",{className:"text-sm text-slate-500 px-3 py-6",children:"Loading…"}):0===z.length?(0,b.jsx)("div",{className:"text-sm text-slate-500 px-3 py-6",children:"No recent contracts."}):(0,b.jsx)("div",{className:"space-y-2",children:z.slice(0,6).map(a=>{let c,d,e;return(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-[1fr,140px,80px] gap-3 items-center rounded-2xl px-3 py-3 hover:bg-slate-50",children:[(0,b.jsxs)("div",{className:"flex items-center gap-3 min-w-0",children:[(0,b.jsx)("div",{className:"w-9 h-9 rounded-2xl bg-slate-50 border border-slate-200 flex items-center justify-center",children:(0,b.jsx)(j.FileText,{className:"w-4 h-4 text-slate-600"})}),(0,b.jsx)("div",{className:"min-w-0",children:(0,b.jsx)("div",{className:"text-sm font-extrabold text-slate-900 truncate",children:a.name})})]}),(0,b.jsx)("div",{className:"md:justify-self-start",children:(0,b.jsx)("span",{className:(c=String(a.status||"").toLowerCase(),d="inline-flex items-center px-2.5 py-1 rounded-full text-xs font-semibold border","approved"===c||"executed"===c||"signed"===c||"completed"===c?`${d} bg-emerald-50 text-emerald-700 border-emerald-200`:"pending"===c||"review"===c||"in_review"===c||"processing"===c?`${d} bg-amber-50 text-amber-700 border-amber-200`:"rejected"===c||"failed"===c||"declined"===c?`${d} bg-rose-50 text-rose-700 border-rose-200`:"sent"===c||"in_progress"===c?`${d} bg-blue-50 text-blue-700 border-blue-200`:`${d} bg-slate-50 text-slate-700 border-slate-200`),children:String(a.status).replace("_"," ")})}),(0,b.jsx)("div",{className:"text-sm text-slate-500 md:text-right",children:Number.isNaN((e=new Date(a.date)).getTime())?"":e.toLocaleString(void 0,{month:"short",day:"numeric"})})]},a.id)})})]})]}),(0,b.jsxs)("div",{className:"xl:col-span-3 space-y-6",children:[(0,b.jsxs)("div",{className:"bg-white/90 border border-slate-200 rounded-[28px] p-6",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsx)("h2",{className:"text-lg font-extrabold text-slate-900",children:"E-Sign Status"}),(0,b.jsx)("button",{className:"w-9 h-9 rounded-xl border border-slate-200 bg-slate-50 text-slate-400","aria-label":"More",children:"⋮"})]}),(0,b.jsxs)("div",{className:"mt-5",children:[(0,b.jsx)("div",{className:"flex items-baseline justify-between",children:(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-xs font-bold text-slate-400",children:"In-house share"}),(0,b.jsxs)("p",{className:"text-3xl font-extrabold text-slate-900 mt-1",children:[T,"%"]})]})}),(0,b.jsx)("div",{className:"mt-4 h-2 rounded-full bg-slate-100 overflow-hidden",children:(0,b.jsx)("div",{className:"h-full bg-rose-400",style:{width:`${T}%`}})}),(0,b.jsxs)("div",{className:"mt-5 space-y-3",children:[(0,b.jsx)("div",{className:"flex items-center justify-between",children:(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)("span",{className:"w-7 h-7 rounded-full border border-emerald-200 bg-emerald-50 inline-flex items-center justify-center text-emerald-700 font-extrabold",children:"✓"}),(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"text-sm font-extrabold text-slate-900",children:"In-house"}),(0,b.jsxs)("div",{className:"text-xs text-slate-500",children:[R," contracts"]})]})]})}),(0,b.jsx)("div",{className:"flex items-center justify-between",children:(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)("span",{className:"w-7 h-7 rounded-full border border-amber-200 bg-amber-50 inline-flex items-center justify-center text-amber-700 font-extrabold",children:"8"}),(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"text-sm font-extrabold text-slate-900",children:"Other"}),(0,b.jsxs)("div",{className:"text-xs text-slate-500",children:[S," contracts"]})]})]})})]})]})]}),(0,b.jsxs)("div",{className:"bg-white/90 border border-slate-200 rounded-[28px] p-6",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsx)("h2",{className:"text-lg font-extrabold text-slate-900",children:"Reminders"}),(0,b.jsx)("button",{className:"w-9 h-9 rounded-xl border border-slate-200 bg-slate-50 text-slate-400","aria-label":"More",children:"⋮"})]}),(0,b.jsxs)("div",{className:"mt-5 space-y-3",children:[B.map((a,c)=>{var d,e;let f;return(0,b.jsxs)("div",{className:"rounded-2xl border border-slate-200 bg-slate-50 p-4",children:[(0,b.jsx)("p",{className:"text-[11px] font-bold text-slate-400",children:(d=a.start,e=a.allDay,Number.isNaN((f=new Date(d)).getTime())?"UPCOMING":e?f.toLocaleDateString(void 0,{weekday:"short",month:"short",day:"numeric"}).toUpperCase():f.toLocaleString(void 0,{weekday:"short",month:"short",day:"numeric",hour:"numeric",minute:"2-digit"}).toUpperCase())}),(0,b.jsx)("p",{className:"mt-1 text-sm font-extrabold text-slate-900",children:a.title})]},a.id||String(c))}),B.length?null:(0,b.jsx)("div",{className:"rounded-2xl border border-slate-200 bg-slate-50 p-4 text-sm text-slate-500",children:"No upcoming reminders."})]}),(0,b.jsx)("button",{className:"mt-5 w-full rounded-2xl bg-[#0F141F] text-white py-3 text-sm font-extrabold",onClick:()=>a.push("/calendar"),type:"button",children:"Add Reminder"})]})]})]})]})};function t(){return(0,b.jsx)(s,{})}a.s(["default",()=>t],20731)}];

//# sourceMappingURL=app_dashboard_page_tsx_42ef5b16._.js.map