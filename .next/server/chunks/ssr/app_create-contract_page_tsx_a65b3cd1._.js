module.exports=[4117,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(50944),e=a.i(64440),f=a.i(98448),g=a.i(52072),h=a.i(49076),i=a.i(13749),j=a.i(4720),k=a.i(87532),l=a.i(8406),m=a.i(41417);let n=["Mutual_NDA.txt","MSA_Master_Services.txt","SOW_Statement_of_Work.txt","Contractor_Agreement.txt"],o={"Mutual_NDA.txt":{title:"Mutual NDA",subtitle:"Protect confidential information between two parties.",pill:"Standard",eta:"~5 mins",iconBg:"bg-blue-50 text-blue-600",icon:(0,b.jsx)(j.FileText,{className:"w-5 h-5"})},"MSA_Master_Services.txt":{title:"MSA (Master Services)",subtitle:"Framework agreement for ongoing service relationships.",pill:"Complex",eta:"~15 mins",iconBg:"bg-orange-50 text-orange-600",icon:(0,b.jsx)(j.FileText,{className:"w-5 h-5"})},"SOW_Statement_of_Work.txt":{title:"SOW (Statement of Work)",subtitle:"Define specific project deliverables and timelines.",pill:"Project",eta:"~10 mins",iconBg:"bg-emerald-50 text-emerald-600",icon:(0,b.jsx)(j.FileText,{className:"w-5 h-5"})},"Contractor_Agreement.txt":{title:"Contractor Agreement",subtitle:"Terms for independent contractors and freelancers.",pill:"HR",eta:"~8 mins",iconBg:"bg-violet-50 text-violet-600",icon:(0,b.jsx)(j.FileText,{className:"w-5 h-5"})}},p=()=>{let a=(0,d.useRouter)(),p=(0,d.useSearchParams)(),{user:q}=(0,e.useAuth)(),[r,s]=(0,c.useState)("templates"),[t,u]=(0,c.useState)([]),[v,w]=(0,c.useState)(""),[x,y]=(0,c.useState)(""),[z,A]=(0,c.useState)(!1),[B,C]=(0,c.useState)(!1),[D,E]=(0,c.useState)(null),[F,G]=(0,c.useState)({}),[H,I]=(0,c.useState)(!1),[J,K]=(0,c.useState)(null),[L,M]=(0,c.useState)(!1),[N,O]=(0,c.useState)([]),[P,Q]=(0,c.useState)(""),[R,S]=(0,c.useState)([]),[T,U]=(0,c.useState)([]),[V,W]=(0,c.useState)([]),[X,Y]=(0,c.useState)([]),[Z,$]=(0,c.useState)(!1),[_,aa]=(0,c.useState)(""),[ab,ac]=(0,c.useState)(""),[ad,ae]=(0,c.useState)(!1),[af,ag]=(0,c.useState)(null),[ah,ai]=(0,c.useState)(!1),[aj,ak]=(0,c.useState)("select"),[al,am]=(0,c.useState)(""),[an,ao]=(0,c.useState)(""),[ap,aq]=(0,c.useState)(""),[ar,as]=(0,c.useState)(""),[at,au]=(0,c.useState)(""),[av,aw]=(0,c.useState)(""),[ax,ay]=(0,c.useState)(!1),[az,aA]=(0,c.useState)(!1),[aB,aC]=(0,c.useState)(null),[aD,aE]=(0,c.useState)(null),aF=(0,c.useRef)(null),aG=(0,c.useRef)(null),aH=(0,c.useRef)(""),aI=(0,c.useMemo)(()=>String(q?.user_id||q?.id||q?.email||"anon"),[q]),aJ=a=>`clm:aiBuilderDraft:v1:${aI}:${a}`,aK=a=>`clm:templateGeneratorDraft:v1:${aI}:${a}`,aL=a=>{try{localStorage.removeItem(aK(a))}catch{}},aM=a=>{try{let b;localStorage.setItem((b=a.contractId,`clm:contractGenerationContext:v1:${b}`),JSON.stringify(a))}catch{}},aN=a=>{try{let b=localStorage.getItem(aJ(a));if(!b)return null;let c=JSON.parse(b);if(!c||"object"!=typeof c)return null;return{template:String(c.template||a),title:String(c.title||""),html:String(c.html||""),text:String(c.text||""),updatedAt:Number(c.updatedAt||0)}}catch{return null}},aO=(a,b)=>{try{localStorage.setItem(aJ(a),JSON.stringify(b))}catch{}},aP=a=>{let b=(a||"").replaceAll("&","&amp;").replaceAll("<","&lt;").replaceAll(">","&gt;").replaceAll('"',"&quot;").replaceAll("'","&#039;");return`<p>${b.replace(/\n/g,"<br/>")}</p>`};(0,c.useEffect)(()=>{aV()},[]),(0,c.useEffect)(()=>{let a=p.get("template");a&&y(a)},[p]),(0,c.useEffect)(()=>{"ai"===(p.get("mode")||p.get("builder")||"").toLowerCase()&&s("ai")},[p]),(0,c.useEffect)(()=>{if(!x){K(null),G({}),S([]),U([]),W([]),ac(""),ag(null),ai(!1),ak("select"),am(""),ao(""),aq(""),as(""),au(""),aC(null),aE(null);return}(async()=>{try{I(!0);let a=new f.ApiClient,b=await a.getTemplateFileSchema(x);if(!b.success)return void K(null);let c=b.data;K(c);let d=[];for(let a of c.sections||[])for(let b of a.fields||[])b?.key&&d.push(b.key);G(a=>{let b={...a};for(let a of d)void 0===b[a]&&(b[a]="");return b}),M(!0);let e=await a.getClauses({contract_type:c.template_type});if(e.success){let a=e.data,b=Array.isArray(a)?a:Array.isArray(a?.results)?a.results:[];O(b)}else O([]);$(!0);let g=await a.getConstraintsLibrary({});if(g.success){let a=g.data,b=Array.isArray(a?.results)?a.results:Array.isArray(a)?a:[];Y(b)}else Y([])}finally{I(!1),M(!1),$(!1)}})()},[x]),(0,c.useEffect)(()=>{if("templates"!==r||!q||!x||0!==Object.keys(F||{}).length||0!==(R||[]).length||0!==(T||[]).length||0!==(V||[]).length)return;let a=(a=>{try{let b=localStorage.getItem(aK(a));if(!b)return null;let c=JSON.parse(b);if(!c||"object"!=typeof c)return null;return{template:String(c.template||a),fieldValues:c.fieldValues||{},selectedClauseIds:Array.isArray(c.selectedClauseIds)?c.selectedClauseIds:[],customClauses:Array.isArray(c.customClauses)?c.customClauses:[],constraints:Array.isArray(c.constraints)?c.constraints:[],updatedAt:Number(c.updatedAt||0)}}catch{return null}})(x);if(!a){ag(null),ai(!1);return}G(a.fieldValues||{}),S(a.selectedClauseIds||[]),U(a.customClauses||[]),W(a.constraints||[]),ag(a.updatedAt||null),ai(!0)},[r,q,x]),(0,c.useEffect)(()=>{if("templates"!==r||!q||!x)return;let a=window.setTimeout(()=>{let a={template:x,fieldValues:F||{},selectedClauseIds:R||[],customClauses:T||[],constraints:V||[],updatedAt:Date.now()};try{localStorage.setItem(aK(x),JSON.stringify(a))}catch{}ag(a.updatedAt)},350);return()=>window.clearTimeout(a)},[r,q,x,F,R,T,V]),(0,c.useEffect)(()=>{if("ai"!==r)return;if(!x)return void aE(null);let a=aN(x);aE(a?.updatedAt?a.updatedAt:null)},[r,x,aI]),(0,c.useEffect)(()=>{if("ai"!==r||!x)return;let a=aN(x);if(a&&(a.html||a.text)){aC(null),am(a.title||String(aY?.name||x)),aq(a.text||""),as(a.html||aP(a.text||"")),au(""),ak("edit"),aE(a.updatedAt||Date.now());return}"ai"!==(p.get("mode")||"").toLowerCase()&&"1"!==(p.get("autostart")||"")||"select"!==aj||aH.current!==x&&(aH.current=x,aQ())},[r,x,aj,p,aI]),(0,c.useEffect)(()=>{if("ai"!==r||"edit"!==aj||!x||!ar&&!ap)return;let a=window.setTimeout(()=>{let a={template:x,title:String(al||aY?.name||x),html:ar,text:ap,updatedAt:Date.now()};aO(x,a),aE(a.updatedAt)},650);return()=>window.clearTimeout(a)},[r,aj,x,al,ar,ap]);let aQ=async()=>{if(x)try{let a=aN(x);if(a&&(a.html||a.text)){aC(null),am(a.title||String(aY?.name||x)),aq(a.text||""),as(a.html||aP(a.text||"")),au(""),ak("edit"),aE(a.updatedAt||Date.now());return}aC(null),ay(!0);let b=new f.ApiClient,c=await b.getTemplateFileContent(x);if(!c.success)return void aC(c.error||"Failed to load template");let d=String(c.data?.content||""),e=String(c.data?.name||"")||String(x||"Template");am(e),aq(d),as(aP(d)),au(""),ak("edit");let g={template:x,title:e,html:aP(d),text:d,updatedAt:Date.now()};aO(x,g),aE(g.updatedAt)}catch(a){aC(a instanceof Error?a.message:"Failed to load template")}finally{ay(!1)}},aR=async()=>{if(az)return;let a=an.trim();if(!a)return void aC("Please enter a prompt");let b=aG.current?.getText()??ap;if(!b.trim())return void aC("Template content is empty");aF.current?.abort();let c=new AbortController;aF.current=c;try{aC(null),aA(!0);let d="";au("");let e=new f.ApiClient;await e.streamTemplateAiGenerate({prompt:a,current_text:b,contract_type:J?.template_type||aY?.contract_type},{signal:c.signal,onDelta:a=>{d+=a,au(d)},onDone:()=>{au(d)},onError:a=>{aC(a||"AI generation failed")}})}catch(a){if(a?.name==="AbortError")return;aC(a instanceof Error?a.message:"AI generation failed")}finally{aA(!1)}},aS=()=>{aF.current?.abort(),aA(!1)},aT=async()=>{try{if(aC(null),!q)return void aC("Please sign in to create a draft.");C(!0);let b=new f.ApiClient,c=aG.current?.getText()??ap,d=aG.current?.getHTML()??ar,e=(0,m.sanitizeEditorHtml)(d),g=(al||aY?.name||"Contract").trim(),h=await b.createContractFromContent({title:g,contract_type:J?.template_type||aY?.contract_type,rendered_text:c,rendered_html:e,metadata:x?{source:"ai_builder",template_filename:x,template:x,form_inputs:F||{},selected_clause_ids:R||[],selected_clauses:R||[],custom_clauses:T||[],constraints:V||[],editor_client_updated_at_ms:Date.now()}:{source:"ai_builder",editor_client_updated_at_ms:Date.now()}});if(!h.success)return void aC(h.error||"Failed to create draft");let i=String(h.data?.id||"");if(!i)return void aC("Draft created but no contract id returned");if(x&&aM({contractId:String(i),template:x,fieldValues:F||{},selectedClauseIds:R||[],customClauses:T||[],constraints:V||[],updatedAt:aD||Date.now(),createdAt:Date.now()}),x){try{localStorage.removeItem(aJ(x))}catch{}aE(null)}a.push(`/contracts/editor?id=${encodeURIComponent(i)}`)}catch(a){aC(a instanceof Error?a.message:"Failed to create draft")}finally{C(!1)}},aU=(0,c.useMemo)(()=>{let a=Array.isArray(N)?N:[],b=P.trim().toLowerCase();return b?a.filter(a=>`${a.clause_id} ${a.name} ${a.content}`.toLowerCase().includes(b)):a},[N,P]),aV=async()=>{try{A(!0);let a=new f.ApiClient,b=await a.listTemplateFiles();if(b.success){let a=b.data?.results||[];if(u(a),!p.get("template")&&a.length>0){let b=a.find(a=>n.includes(a.filename));y((b||a[0]).filename)}}else E(b.error||"Failed to load templates"),u([])}catch(a){console.error("Failed to fetch data:",a),E("Failed to load templates")}finally{A(!1)}};(0,c.useEffect)(()=>{if(!x||"templates"!==r||!q)return;let a=window.setTimeout(async()=>{try{ae(!0);let a=new f.ApiClient,b=await a.previewContractFromFile({filename:x,structuredInputs:F,selectedClauses:R,customClauses:T,constraints:V});b.success&&ac(b.data?.rendered_text||"")}finally{ae(!1)}},350);return()=>window.clearTimeout(a)},[x,F,R,T,V,r,q]);let aW=(a,b)=>{G(c=>({...c,[a]:b}))},aX=async b=>{if(b.preventDefault(),!x)return void E("Please select a template");let c=x&&(o[x]?.title||aY?.name)||"Contract",d=F.party_a_name||F.party_b_name||F.company_name||F.client_name||F.disclosing_party_name||F.receiving_party_name||"",e=d?`${c} — ${d}`:c;C(!0),E(null);try{let b=new f.ApiClient,c=await b.generateContractFromFile({filename:x,title:e,selectedClauses:R,customClauses:T,constraints:V,structuredInputs:F});if(!c.success)return void E(c.error||"Failed to create contract");let d=c.data?.contract?.id;d?(aM({contractId:String(d),template:x,fieldValues:F||{},selectedClauseIds:R||[],customClauses:T||[],constraints:V||[],updatedAt:af||Date.now(),createdAt:Date.now()}),aL(x),ai(!1),ag(null),a.push(`/contracts/editor?id=${encodeURIComponent(String(d))}`)):a.push("/contracts")}catch(a){console.error("Failed to create contract:",a),E(a instanceof Error?a.message:"Failed to create contract")}finally{C(!1)}},aY=t.find(a=>a.filename===x)||null,aZ=(0,c.useMemo)(()=>{let a=new Set(n),b=[],c=new Map;for(let a of t)c.set(a.filename,a);for(let a of n){let d=c.get(a);d&&b.push(d)}return[...b,...t.filter(b=>!a.has(b.filename))]},[t]),a$=(0,c.useMemo)(()=>{let a=v.trim().toLowerCase();return a?aZ.filter(b=>`${b.filename||""} ${b.name||""} ${b.description||""} ${b.contract_type||""}`.toLowerCase().includes(a)):aZ},[aZ,v]),a_=(0,c.useMemo)(()=>{let a=av.trim().toLowerCase();return a?aZ.filter(b=>`${b.filename||""} ${b.name||""} ${b.description||""} ${b.contract_type||""}`.toLowerCase().includes(a)):aZ},[aZ,av]),a0=J?.sections||[],a1=!q||!aY||B||"templates"!==r;return(0,b.jsx)(g.default,{children:(0,b.jsx)("div",{className:"min-h-screen bg-[#F2F0EB]",children:(0,b.jsxs)("div",{className:"max-w-[1280px] mx-auto px-4 md:px-8 py-6 md:py-8",children:[(0,b.jsx)("div",{className:"flex flex-col sm:flex-row sm:items-start sm:justify-between gap-4 sm:gap-6",children:(0,b.jsxs)("div",{children:[(0,b.jsx)("h1",{className:"text-[28px] md:text-[34px] font-semibold text-[#0F141F] leading-tight",children:"Contract Generator"}),(0,b.jsx)("p",{className:"text-sm md:text-base text-[#6B7280] mt-1",children:"Select a template and autofill details to generate contracts instantly."})]})}),(0,b.jsx)("div",{className:"mt-6 flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:(0,b.jsxs)("div",{className:"flex w-full sm:w-auto items-center rounded-full bg-white border border-black/5 p-1 shadow-sm",children:[(0,b.jsx)("button",{type:"button",onClick:()=>s("templates"),className:`flex-1 sm:flex-none px-4 py-2 rounded-full text-sm font-medium transition text-center ${"templates"===r?"bg-[#0F141F] text-white":"text-[#0F141F]/70 hover:text-[#0F141F]"}`,children:"Template Based"}),(0,b.jsxs)("button",{type:"button",onClick:()=>s("ai"),className:`flex-1 sm:flex-none px-4 py-2 rounded-full text-sm font-medium transition flex items-center justify-center gap-2 ${"ai"===r?"bg-[#0F141F] text-white":"text-[#0F141F]/70 hover:text-[#0F141F]"}`,children:[(0,b.jsx)(l.Sparkles,{className:"w-4 h-4"})," AI Builder"]})]})}),"ai"===r?(0,b.jsx)("div",{className:"mt-8",children:"select"===aj?(0,b.jsxs)("div",{className:"grid grid-cols-12 gap-6",children:[(0,b.jsxs)("aside",{className:"col-span-12 lg:col-span-3 bg-white rounded-[18px] border border-black/5 shadow-sm overflow-hidden",children:[(0,b.jsxs)("div",{className:"px-6 pt-6 pb-4 border-b border-black/5",children:[(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsx)("div",{className:"w-10 h-10 rounded-xl bg-[#0F141F] text-white flex items-center justify-center",children:(0,b.jsx)(l.Sparkles,{className:"w-5 h-5"})}),(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"text-lg font-semibold text-[#0F141F]",children:"AI Builder"}),(0,b.jsx)("div",{className:"text-xs text-[#6B7280]",children:"Pick a template to start"})]})]}),(0,b.jsxs)("div",{className:"mt-4 flex items-center gap-2 bg-[#F6F3ED] rounded-full px-4 py-2",children:[(0,b.jsx)(k.Search,{className:"w-4 h-4 text-black/35"}),(0,b.jsx)("input",{className:"bg-transparent outline-none text-sm w-full",placeholder:"Search templates…",value:av,onChange:a=>aw(a.target.value)})]}),(0,b.jsx)("div",{className:"mt-3 text-[11px] text-black/45",children:av.trim()?`Showing ${a_.length} results`:`Showing ${a_.length} templates`})]}),(0,b.jsx)("div",{className:"p-4 space-y-3 overflow-y-auto max-h-[45vh] sm:max-h-[55vh] lg:max-h-[calc(100vh-320px)]",children:0===a_.length?(0,b.jsx)("div",{className:"text-sm text-black/45 p-2",children:"No templates match your search."}):a_.map(a=>{let c=x===a.filename;return(0,b.jsxs)("button",{type:"button",onClick:()=>y(a.filename),className:`w-full text-left rounded-2xl border p-4 transition ${c?"border-[#FF5C7A] bg-[#FFF1F4]":"border-black/5 bg-[#F6F3ED] hover:border-black/10"}`,children:[(0,b.jsx)("div",{className:"text-sm font-semibold text-[#111827] truncate",children:a.name||a.filename}),(0,b.jsx)("div",{className:"text-xs text-black/45 mt-1 line-clamp-2",children:a.description||a.contract_type||""})]},a.filename)})})]}),(0,b.jsxs)("section",{className:"col-span-12 lg:col-span-9 bg-white rounded-[18px] border border-black/5 shadow-sm p-5 sm:p-6 lg:p-8",children:[(0,b.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"text-lg font-semibold text-[#0F141F]",children:"Get Started"}),(0,b.jsx)("div",{className:"text-sm text-[#6B7280] mt-1",children:"Open the template in the editor and apply prompts live."})]}),(0,b.jsx)("button",{type:"button",onClick:aQ,disabled:!x||ax,className:"h-11 w-full sm:w-auto px-5 rounded-full bg-[#0F141F] text-white text-sm font-semibold disabled:opacity-60",children:ax?"Loading…":aD?"Resume Draft":"Get Started"})]}),aD?(0,b.jsxs)("div",{className:"mt-4 rounded-2xl border border-black/10 bg-[#F6F3ED] px-4 py-3 text-sm text-black/60",children:["Saved draft found — last updated ",new Date(aD).toLocaleString(),"."]}):null,aB?(0,b.jsx)("div",{className:"mt-5 bg-rose-50 border border-rose-200 text-rose-700 px-4 py-3 rounded-2xl text-sm",children:aB}):null,(0,b.jsxs)("div",{className:"mt-6",children:[(0,b.jsx)("div",{className:"text-sm font-semibold text-[#0F141F]",children:"Selected Template"}),(0,b.jsxs)("div",{className:"mt-3 rounded-2xl border border-black/5 bg-[#F6F3ED] p-4",children:[(0,b.jsx)("div",{className:"text-sm font-semibold text-[#111827]",children:aY?.name||x||"—"}),(0,b.jsx)("div",{className:"text-xs text-black/45 mt-1",children:aY?.description||"Template preview will open in the editor."})]})]})]})]}):(0,b.jsxs)("div",{className:"bg-[#F2F0EB]",children:[(0,b.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4 mb-6",children:[(0,b.jsxs)("div",{className:"flex items-center gap-4 min-w-0",children:[(0,b.jsx)("button",{type:"button",onClick:()=>{aS(),ak("select")},className:"w-10 h-10 rounded-full bg-white border border-black/10 shadow-sm grid place-items-center text-black/45 hover:text-black","aria-label":"Back",children:(0,b.jsx)(i.ChevronLeft,{className:"w-5 h-5"})}),(0,b.jsxs)("div",{className:"min-w-0",children:[(0,b.jsx)("div",{className:"text-xl md:text-2xl font-bold text-[#111827] truncate",children:al||aY?.name||"AI Builder"}),(0,b.jsxs)("div",{className:"text-xs text-black/45 mt-1 truncate",children:["Template: ",x||""]})]})]}),(0,b.jsx)("div",{className:"w-full sm:w-auto flex items-center gap-2",children:(0,b.jsx)("button",{type:"button",onClick:aT,disabled:B||az||!ap.trim()||!q,className:"h-10 w-full sm:w-auto px-4 rounded-full bg-white border border-black/10 text-sm font-semibold text-[#111827] hover:bg-black/5 disabled:opacity-60",children:"Create Draft"})})]}),aB?(0,b.jsx)("div",{className:"mb-6 bg-rose-50 border border-rose-200 text-rose-700 px-4 py-3 rounded-2xl text-sm",children:aB}):null,(0,b.jsxs)("div",{className:"grid grid-cols-12 gap-6",children:[(0,b.jsxs)("section",{className:"col-span-12 lg:col-span-8 bg-white rounded-[28px] border border-black/5 shadow-sm overflow-hidden",children:[(0,b.jsxs)("div",{className:"px-5 py-4 border-b border-black/5 flex items-center justify-between",children:[(0,b.jsx)("div",{className:"text-sm font-semibold text-[#111827]",children:"Template Editor"}),(0,b.jsx)("div",{className:"text-xs text-black/45",children:az?"Generating suggestion…":"Edit content; accept AI suggestions on the right"})]}),(0,b.jsx)("div",{className:"px-4 sm:px-6 py-5 sm:py-6 overflow-visible lg:overflow-y-auto lg:max-h-[calc(100vh-280px)]",children:(0,b.jsx)(h.default,{valueHtml:ar,disabled:az,onEditorReady:a=>{aG.current=a},onChange:(a,b)=>{as(a),aq(b)},editorClassName:`min-h-[50vh] sm:min-h-[60vh] rounded-2xl border border-black/10 bg-white px-5 py-4 text-[13px] leading-6 text-slate-900 font-serif outline-none ${az?"opacity-80":""}`})})]}),(0,b.jsx)("aside",{className:"col-span-12 lg:col-span-4 space-y-6",children:(0,b.jsxs)("div",{className:"bg-white rounded-[28px] border border-black/5 shadow-sm overflow-hidden",children:[(0,b.jsxs)("div",{className:"px-6 pt-6 pb-4 border-b border-black/5",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsx)("p",{className:"text-sm font-semibold text-[#111827]",children:"AI Suggestions"}),(0,b.jsx)("span",{className:"text-[11px] text-black/45",children:"Streaming"})]}),(0,b.jsx)("p",{className:"text-xs text-black/45 mt-2",children:"Generate a proposed revision, then accept or reject it."})]}),(0,b.jsxs)("div",{className:"p-5",children:[(0,b.jsx)("textarea",{value:an,onChange:a=>ao(a.target.value),placeholder:"e.g., Add a termination for convenience clause with 30 days notice, and update payment terms to Net 45.",className:"w-full min-h-[140px] rounded-2xl border border-black/10 bg-[#F6F3ED] px-4 py-3 text-sm outline-none focus:ring-2 focus:ring-[#FF5C7A]/25",disabled:az}),(0,b.jsxs)("div",{className:"mt-4 flex flex-col sm:flex-row sm:items-center gap-2",children:[(0,b.jsx)("button",{type:"button",onClick:aR,disabled:az||!an.trim(),className:"h-10 w-full sm:w-auto px-4 rounded-full bg-[#0F141F] text-white text-sm font-semibold disabled:opacity-60",children:az?"Generating…":"Generate Suggestion"}),az?(0,b.jsx)("button",{type:"button",onClick:aS,className:"h-10 w-full sm:w-auto px-4 rounded-full bg-white border border-black/10 text-sm font-semibold text-[#111827] hover:bg-black/5",children:"Stop"}):null]}),aB?(0,b.jsx)("div",{className:"mt-3 text-xs text-rose-600",children:aB}):null,(0,b.jsx)("div",{className:"mt-4 text-xs text-black/45",children:"Tip: be specific (sections, numbers, jurisdictions)."}),(0,b.jsxs)("div",{className:"mt-5 rounded-2xl border border-black/10 bg-white overflow-hidden",children:[(0,b.jsxs)("div",{className:"px-4 py-3 border-b border-black/5 flex items-center justify-between",children:[(0,b.jsx)("div",{className:"text-xs font-semibold text-[#111827]",children:"Proposed Revision"}),(0,b.jsx)("div",{className:"text-[11px] text-black/45",children:at.trim()?"Ready":"None yet"})]}),(0,b.jsxs)("div",{className:"p-4",children:[at.trim()?(0,b.jsx)("div",{className:"text-xs text-slate-800 whitespace-pre-wrap max-h-64 overflow-y-auto",children:at}):(0,b.jsx)("div",{className:"text-sm text-[#6B7280]",children:"Run a prompt to generate suggestions."}),(0,b.jsxs)("div",{className:"mt-4 flex flex-col sm:flex-row sm:items-center gap-2",children:[(0,b.jsx)("button",{type:"button",onClick:()=>{let a=(at||"").trim();a&&(aq(a),as(aP(a)),au(""))},disabled:!at.trim()||az,className:"h-10 w-full sm:w-auto px-4 rounded-full bg-[#FF5C7A] text-white text-sm font-semibold disabled:opacity-60",children:"Accept"}),(0,b.jsx)("button",{type:"button",onClick:()=>{au("")},disabled:!at.trim()||az,className:"h-10 w-full sm:w-auto px-4 rounded-full bg-white border border-black/10 text-sm font-semibold text-[#111827] hover:bg-black/5 disabled:opacity-60",children:"Reject"})]})]})]})]})]})})]})]})}):(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)("div",{className:"mt-8",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between gap-4 flex-wrap",children:[(0,b.jsx)("h2",{className:"text-sm font-semibold text-[#0F141F]",children:"All Templates"}),(0,b.jsxs)("div",{className:"flex items-center gap-2 bg-white border border-black/5 shadow-sm rounded-full px-4 py-2 w-full sm:w-[420px]",children:[(0,b.jsx)(k.Search,{className:"w-4 h-4 text-black/35"}),(0,b.jsx)("input",{value:v,onChange:a=>w(a.target.value),placeholder:"Search templates…",className:"bg-transparent outline-none text-sm w-full text-[#0F141F] placeholder:text-black/35","aria-label":"Search templates"})]})]}),(0,b.jsx)("div",{className:"mt-4",children:z?(0,b.jsx)("div",{className:"text-sm text-[#6B7280] py-6",children:"Loading templates…"}):0===a$.length?(0,b.jsx)("div",{className:"text-sm text-[#6B7280] py-6",children:"No templates match your search."}):(0,b.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4",children:a$.map(a=>{let c=x===a.filename,d=o[a.filename]||{title:a.name,subtitle:a.description||"Template",pill:a.contract_type||"Template",eta:"~5 mins",iconBg:"bg-slate-50 text-slate-700",icon:(0,b.jsx)(j.FileText,{className:"w-5 h-5"})},e=q&&a?.created_by_id&&String(a.created_by_id)===String(q?.user_id);return(0,b.jsx)("button",{type:"button",onClick:()=>y(a.filename),className:`text-left bg-white rounded-[18px] border shadow-sm p-5 transition w-full ${c?"border-[#FF5C7A] ring-2 ring-[#FF5C7A]/20":"border-black/5 hover:border-black/10"}`,children:(0,b.jsxs)("div",{className:"flex items-start justify-between gap-3",children:[(0,b.jsx)("div",{className:`w-10 h-10 rounded-xl ${d.iconBg} flex items-center justify-center flex-shrink-0`,children:d.icon}),(0,b.jsxs)("div",{className:"min-w-0 flex-1",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between gap-2",children:[(0,b.jsx)("div",{className:"font-semibold text-[#0F141F] truncate",children:d.title}),(0,b.jsx)("div",{className:`w-6 h-6 rounded-full flex items-center justify-center border flex-shrink-0 ${c?"bg-[#FF5C7A] border-[#FF5C7A]":"bg-white border-black/10"}`,children:c?(0,b.jsx)("div",{className:"w-2.5 h-2.5 rounded-full bg-white"}):null})]}),(0,b.jsx)("div",{className:"text-sm text-[#6B7280] mt-1 line-clamp-2",children:d.subtitle}),(0,b.jsxs)("div",{className:"mt-3 flex items-center gap-2 flex-wrap",children:[(0,b.jsx)("span",{className:"text-xs px-2.5 py-1 rounded-full bg-[#F3F4F6] text-[#0F141F]/70",children:d.pill}),e?(0,b.jsx)("span",{className:"text-xs px-2.5 py-1 rounded-full bg-[#F6F3ED] text-[#0F141F]/70 border border-black/5",children:"Mine"}):null,(0,b.jsx)("span",{className:"text-[11px] text-[#6B7280] truncate",children:a.filename})]})]})]})},a.filename)})})})]}),D&&(0,b.jsx)("div",{className:"mt-6 bg-red-50 border border-red-200 text-red-700 px-6 py-4 rounded-2xl",children:(0,b.jsx)("p",{className:"font-medium",children:D})}),(0,b.jsxs)("form",{onSubmit:aX,className:"mt-6 grid grid-cols-1 lg:grid-cols-12 gap-6",children:[(0,b.jsxs)("div",{className:"bg-white rounded-[18px] border border-black/5 shadow-sm overflow-hidden lg:col-span-5",children:[(0,b.jsxs)("div",{className:"px-5 py-4 border-b border-black/5 flex items-center justify-between",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)("div",{className:"w-7 h-7 rounded-full bg-[#FF5C7A] text-white flex items-center justify-center text-xs font-bold",children:"1"}),(0,b.jsx)("div",{className:"font-semibold text-[#0F141F]",children:"Data Entry"})]}),(0,b.jsx)("button",{type:"button",onClick:()=>{G({}),S([]),U([]),W([]),x&&(aL(x),ag(null),ai(!1))},className:"text-xs text-[#FF5C7A] hover:underline",children:"Clear all"})]}),af?(0,b.jsx)("div",{className:"px-5 pt-4",children:(0,b.jsxs)("div",{className:"rounded-2xl border border-black/10 bg-[#F6F3ED] px-4 py-3 flex items-center justify-between gap-3",children:[(0,b.jsxs)("div",{className:"text-xs text-black/60",children:[ah?"Draft restored":"Auto-saved"," — ",new Date(af).toLocaleString()]}),x?(0,b.jsx)("button",{type:"button",onClick:()=>{aL(x),ag(null),ai(!1)},className:"text-xs font-semibold text-[#0F141F] hover:underline",children:"Clear draft"}):null]})}):null,(0,b.jsx)("div",{className:"p-5 space-y-6",children:x?H?(0,b.jsx)("div",{className:"text-sm text-[#6B7280]",children:"Loading required fields…"}):(0,b.jsxs)(b.Fragment,{children:[(a0.length?a0:[{title:"Data Entry",fields:[]}]).map(a=>(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"text-[11px] tracking-wider text-[#9CA3AF] font-semibold uppercase",children:a.title}),(0,b.jsx)("div",{className:"mt-3 grid grid-cols-1 md:grid-cols-2 gap-4",children:(a.fields||[]).map(a=>(0,b.jsxs)("div",{className:"select"===a.type?"md:col-span-1":"",children:[(0,b.jsxs)("label",{className:"block text-sm font-medium text-[#374151] mb-2",children:[a.label," ",a.required?(0,b.jsx)("span",{className:"text-[#FF5C7A]",children:"*"}):null]}),"select"===a.type?(0,b.jsxs)("select",{value:F[a.key]||"",onChange:b=>aW(a.key,b.target.value),className:"w-full px-4 py-3 border border-black/10 rounded-xl bg-white focus:ring-2 focus:ring-[#FF5C7A]/30 focus:border-[#FF5C7A]/40",children:[(0,b.jsx)("option",{value:"",children:"Select…"}),(a.options||[]).map(a=>(0,b.jsx)("option",{value:a,children:a},a))]}):(0,b.jsx)("input",{type:a.type,value:F[a.key]||"",onChange:b=>aW(a.key,b.target.value),className:"w-full px-4 py-3 border border-black/10 rounded-xl bg-white focus:ring-2 focus:ring-[#FF5C7A]/30 focus:border-[#FF5C7A]/40",placeholder:a.label})]},a.key))})]},a.title)),(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"text-[11px] tracking-wider text-[#9CA3AF] font-semibold uppercase",children:"Clause & Constraints"}),(0,b.jsxs)("div",{className:"mt-3 space-y-4",children:[(0,b.jsxs)("div",{className:"bg-[#F7F7F7] rounded-2xl p-4 border border-black/5",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsx)("div",{className:"font-semibold text-[#111827] text-sm",children:"Clause Library"}),(0,b.jsx)("div",{className:"text-xs text-[#6B7280]",children:"Optional"})]}),(0,b.jsx)("div",{className:"mt-3",children:(0,b.jsx)("input",{value:P,onChange:a=>Q(a.target.value),placeholder:"Search clauses…",className:"w-full px-4 py-2.5 border border-black/10 rounded-xl bg-white focus:ring-2 focus:ring-[#FF5C7A]/30 focus:border-[#FF5C7A]/40"})}),(0,b.jsx)("div",{className:"mt-3 max-h-44 overflow-y-auto space-y-2 pr-1",children:L?(0,b.jsx)("div",{className:"text-sm text-[#6B7280]",children:"Loading clauses…"}):0===aU.length?(0,b.jsx)("div",{className:"text-sm text-[#6B7280]",children:"No clauses found."}):aU.slice(0,50).map(a=>{let c=R.includes(a.clause_id);return(0,b.jsxs)("label",{className:"flex items-start gap-3 bg-white rounded-xl border border-black/5 p-3 cursor-pointer hover:border-black/10",children:[(0,b.jsx)("input",{type:"checkbox",checked:c,onChange:()=>{var b;return b=a.clause_id,void S(a=>a.includes(b)?a.filter(a=>a!==b):[...a,b])},className:"mt-1"}),(0,b.jsxs)("div",{className:"min-w-0",children:[(0,b.jsx)("div",{className:"text-sm font-semibold text-[#111827] truncate",children:a.name}),(0,b.jsx)("div",{className:"text-xs text-[#6B7280]",children:a.clause_id})]})]},`${a.clause_id}-${a.version}`)})})]}),(0,b.jsxs)("div",{className:"bg-[#F7F7F7] rounded-2xl p-4 border border-black/5",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsx)("div",{className:"font-semibold text-[#111827] text-sm",children:"Constraints"}),(0,b.jsx)("button",{type:"button",onClick:()=>W(a=>[...a,{name:"",value:""}]),className:"text-xs px-3 py-1.5 rounded-full bg-white border border-black/10 hover:border-black/20",children:"Add"})]}),(0,b.jsxs)("div",{className:"mt-3",children:[(0,b.jsx)("div",{className:"text-xs font-semibold text-[#6B7280]",children:"Constraint Library"}),(0,b.jsx)("input",{value:_,onChange:a=>aa(a.target.value),placeholder:"Search constraints…",className:"mt-2 w-full px-4 py-2.5 border border-black/10 rounded-xl bg-white focus:ring-2 focus:ring-[#FF5C7A]/30 focus:border-[#FF5C7A]/40"}),(0,b.jsx)("div",{className:"mt-2 max-h-44 overflow-y-auto space-y-2 pr-1",children:Z?(0,b.jsx)("div",{className:"text-sm text-[#6B7280]",children:"Loading constraints…"}):0===X.length?(0,b.jsx)("div",{className:"text-sm text-[#6B7280]",children:"No constraints available."}):X.filter(a=>{let b=_.trim().toLowerCase();return!b||`${a.label||""} ${a.key||""} ${a.category||""}`.toLowerCase().includes(b)}).slice(0,40).map(a=>(0,b.jsx)("button",{type:"button",onClick:()=>{let b;(b=(a?.label||a?.key||"").trim())&&W(c=>c.some(a=>(a.name||"").trim().toLowerCase()===b.toLowerCase())?c:[...c,{name:b,value:String(a?.default||"")}])},className:"w-full text-left bg-white rounded-xl border border-black/5 p-3 hover:border-black/10",children:(0,b.jsxs)("div",{className:"flex items-center justify-between gap-3",children:[(0,b.jsxs)("div",{className:"min-w-0",children:[(0,b.jsx)("div",{className:"text-sm font-semibold text-[#111827] truncate",children:a.label}),(0,b.jsx)("div",{className:"text-xs text-[#6B7280]",children:(a.category||"General")+(a.default?` • Default: ${String(a.default)}`:"")})]}),(0,b.jsx)("div",{className:"text-xs font-semibold text-[#FF5C7A]",children:"Add"})]})},a.key))})]}),(0,b.jsx)("div",{className:"mt-3 space-y-3",children:0===V.length?(0,b.jsx)("div",{className:"text-sm text-[#6B7280]",children:"Add constraints like jurisdiction, data residency, liability caps, etc."}):V.map((a,c)=>(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[(0,b.jsx)("input",{value:a.name,onChange:a=>W(b=>b.map((b,d)=>d===c?{...b,name:a.target.value}:b)),placeholder:"Constraint name",className:"w-full px-4 py-2.5 border border-black/10 rounded-xl bg-white focus:ring-2 focus:ring-[#FF5C7A]/30 focus:border-[#FF5C7A]/40"}),(0,b.jsxs)("div",{className:"flex gap-2",children:[(0,b.jsx)("input",{value:a.value,onChange:a=>W(b=>b.map((b,d)=>d===c?{...b,value:a.target.value}:b)),placeholder:"Value",className:"flex-1 px-4 py-2.5 border border-black/10 rounded-xl bg-white focus:ring-2 focus:ring-[#FF5C7A]/30 focus:border-[#FF5C7A]/40"}),(0,b.jsx)("button",{type:"button",onClick:()=>W(a=>a.filter((a,b)=>b!==c)),className:"px-3 py-2.5 rounded-xl bg-white border border-black/10 hover:border-black/20 text-[#6B7280]","aria-label":"Remove constraint",children:"✕"})]})]},c))})]}),(0,b.jsxs)("div",{className:"bg-[#F7F7F7] rounded-2xl p-4 border border-black/5",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsx)("div",{className:"font-semibold text-[#111827] text-sm",children:"Custom Clauses"}),(0,b.jsx)("button",{type:"button",onClick:()=>U(a=>[...a,{title:"",content:""}]),className:"text-xs px-3 py-1.5 rounded-full bg-white border border-black/10 hover:border-black/20",children:"Add"})]}),(0,b.jsx)("div",{className:"mt-3 space-y-3",children:0===T.length?(0,b.jsx)("div",{className:"text-sm text-[#6B7280]",children:"Add custom clauses like non-solicit, security, SLA, etc."}):T.map((a,c)=>(0,b.jsxs)("div",{className:"bg-white rounded-2xl border border-black/5 p-3",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between gap-2",children:[(0,b.jsx)("input",{value:a.title||"",onChange:a=>U(b=>b.map((b,d)=>d===c?{...b,title:a.target.value}:b)),placeholder:"Clause title",className:"flex-1 px-4 py-2.5 border border-black/10 rounded-xl bg-white focus:ring-2 focus:ring-[#FF5C7A]/30 focus:border-[#FF5C7A]/40"}),(0,b.jsx)("button",{type:"button",onClick:()=>U(a=>a.filter((a,b)=>b!==c)),className:"px-3 py-2.5 rounded-xl bg-white border border-black/10 hover:border-black/20 text-[#6B7280]","aria-label":"Remove custom clause",children:"✕"})]}),(0,b.jsx)("textarea",{value:a.content,onChange:a=>U(b=>b.map((b,d)=>d===c?{...b,content:a.target.value}:b)),placeholder:"Write clause content…",className:"mt-3 w-full px-4 py-3 border border-black/10 rounded-xl bg-white focus:ring-2 focus:ring-[#FF5C7A]/30 focus:border-[#FF5C7A]/40 min-h-[96px]"})]},c))})]})]})]})]}):(0,b.jsx)("div",{className:"text-sm text-[#6B7280]",children:"Select a template to begin."})})]}),(0,b.jsxs)("div",{className:"bg-white rounded-[18px] border border-black/5 shadow-sm overflow-hidden lg:col-span-7 lg:sticky lg:top-6 self-start",children:[(0,b.jsx)("div",{className:"px-5 py-4 border-b border-black/5 flex items-center justify-between",children:(0,b.jsx)("div",{className:"flex items-center gap-2",children:(0,b.jsx)("div",{className:"text-xs text-[#6B7280] font-semibold",children:"Live Preview"})})}),(0,b.jsxs)("div",{className:"p-4",children:[(0,b.jsx)("div",{className:"bg-[#EEF0F3] rounded-[18px] p-2 sm:p-3",children:(0,b.jsx)("div",{className:"bg-white rounded-[14px] shadow-sm border border-black/5 overflow-hidden",children:(0,b.jsx)("div",{className:"p-5 sm:p-6 overflow-visible lg:overflow-y-auto lg:max-h-[calc(100vh-320px)]",children:ad?(0,b.jsx)("div",{className:"text-sm text-[#6B7280]",children:"Generating preview…"}):x?ab?(0,b.jsx)("div",{className:"inline-block min-w-full",children:(0,b.jsx)("pre",{className:"whitespace-pre-wrap text-[13px] leading-relaxed text-[#111827] font-serif",children:ab})}):(0,b.jsx)("div",{className:"text-sm text-[#6B7280]",children:"Start filling fields to see a preview."}):(0,b.jsx)("div",{className:"text-sm text-[#6B7280]",children:"Select a template to preview."})})})}),(0,b.jsxs)("div",{className:"mt-4 flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[(0,b.jsx)("div",{className:"text-sm text-[#6B7280] min-w-0",children:q?J?.template_type?`Type: ${J.template_type}`:null:"Please log in to create contracts."}),(0,b.jsx)("button",{type:"submit",disabled:a1,className:"bg-[#0F141F] text-white w-full sm:w-auto px-7 py-3.5 rounded-full shadow-lg hover:shadow-xl hover:scale-[1.02] transition-all disabled:opacity-50 disabled:cursor-not-allowed whitespace-nowrap flex-shrink-0",children:B?"Creating…":"Move to editor"})]})]})]})]})]})]})})})};a.s(["default",0,()=>(0,b.jsx)(c.Suspense,{fallback:(0,b.jsx)("div",{className:"min-h-screen bg-[#F2F0EB] p-8",children:(0,b.jsx)("div",{className:"max-w-4xl mx-auto",children:(0,b.jsx)("div",{className:"bg-white rounded-[20px] shadow-sm p-6 text-gray-600",children:"Loading..."})})}),children:(0,b.jsx)(p,{})})])}];

//# sourceMappingURL=app_create-contract_page_tsx_a65b3cd1._.js.map