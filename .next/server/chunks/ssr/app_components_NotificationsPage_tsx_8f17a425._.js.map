{"version":3,"sources":["../../../../app/components/NotificationsPage.tsx"],"sourcesContent":["'use client'\n\nimport { useEffect, useState } from 'react'\nimport { apiClient, Notification } from '@/app/lib/api-client'\n\nexport default function NotificationsPage() {\n  const [notifications, setNotifications] = useState<Notification[]>([])\n  const [loading, setLoading] = useState(true)\n  const [error, setError] = useState<string | null>(null)\n  const [filter, setFilter] = useState<'all' | 'unread'>('all')\n\n  useEffect(() => {\n    fetchNotifications()\n    // Refresh every 30 seconds\n    const interval = setInterval(fetchNotifications, 30000)\n    return () => clearInterval(interval)\n  }, [])\n\n  const fetchNotifications = async () => {\n    try {\n      setLoading(true)\n      setError(null)\n      const response = await apiClient.getNotifications()\n\n      if (response.success) {\n        const data = response.data as any\n        const notificationsList = Array.isArray(data) ? data : data.results || []\n        setNotifications(notificationsList)\n      } else {\n        setError(response.error || 'Failed to fetch notifications')\n      }\n    } catch (err) {\n      setError(err instanceof Error ? err.message : 'Unknown error')\n    } finally {\n      setLoading(false)\n    }\n  }\n\n  const handleMarkAsRead = async (id: string) => {\n    try {\n      const response = await apiClient.markNotificationAsRead(id)\n      if (response.success) {\n        await fetchNotifications()\n      } else {\n        setError(response.error || 'Failed to mark as read')\n      }\n    } catch (err) {\n      setError(err instanceof Error ? err.message : 'Unknown error')\n    }\n  }\n\n  const filteredNotifications =\n    filter === 'unread' ? notifications.filter((n) => !n.read) : notifications\n\n  const stats = {\n    total: notifications.length,\n    unread: notifications.filter((n) => !n.read).length,\n  }\n\n  const getTypeColor = (type: string) => {\n    switch (type) {\n      case 'approval_request':\n        return 'bg-blue-100 text-blue-700'\n      case 'approval_approved':\n        return 'bg-emerald-100 text-emerald-700'\n      case 'approval_rejected':\n        return 'bg-red-100 text-red-700'\n      case 'contract_created':\n        return 'bg-purple-100 text-purple-700'\n      case 'workflow_completed':\n        return 'bg-indigo-100 text-indigo-700'\n      default:\n        return 'bg-gray-100 text-gray-700'\n    }\n  }\n\n  const getTypeIcon = (type: string) => {\n    switch (type) {\n      case 'approval_request':\n        return 'üìã'\n      case 'approval_approved':\n        return '‚úÖ'\n      case 'approval_rejected':\n        return '‚ùå'\n      case 'contract_created':\n        return 'üìÑ'\n      case 'workflow_completed':\n        return 'üéâ'\n      default:\n        return 'üì¢'\n    }\n  }\n\n  if (loading && notifications.length === 0) {\n    return (\n      <div className=\"flex items-center justify-center h-screen\">\n        <div className=\"text-center\">\n          <div className=\"w-12 h-12 rounded-full border-4 border-purple-200 border-t-purple-600 animate-spin mx-auto mb-4\"></div>\n          <p className=\"text-gray-600\">Loading notifications...</p>\n        </div>\n      </div>\n    )\n  }\n\n  return (\n    <div className=\"min-h-screen bg-gradient-to-br from-slate-50 to-slate-100 p-8\">\n      <div className=\"max-w-4xl mx-auto\">\n        {/* Header */}\n        <div className=\"mb-8\">\n          <h1 className=\"text-4xl font-bold text-gray-900 mb-2\">Notifications</h1>\n          <p className=\"text-gray-600\">Stay updated with your contract activities</p>\n        </div>\n\n        {/* Error Message */}\n        {error && (\n          <div className=\"mb-6 p-4 bg-red-50 border border-red-200 rounded-lg text-red-700\">\n            {error}\n          </div>\n        )}\n\n        {/* Statistics Cards */}\n        <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4 mb-8\">\n          <div className=\"bg-white rounded-lg p-6 shadow-md\">\n            <p className=\"text-gray-600 text-sm font-medium\">Total Notifications</p>\n            <p className=\"text-3xl font-bold text-gray-900 mt-2\">{stats.total}</p>\n          </div>\n          <div className=\"bg-white rounded-lg p-6 shadow-md\">\n            <p className=\"text-gray-600 text-sm font-medium\">Unread</p>\n            <p className=\"text-3xl font-bold text-amber-700 mt-2\">{stats.unread}</p>\n          </div>\n        </div>\n\n        {/* Filter Tabs */}\n        <div className=\"mb-8 flex gap-2\">\n          <button\n            onClick={() => setFilter('all')}\n            className={`px-4 py-2 rounded-lg font-medium transition ${\n              filter === 'all'\n                ? 'bg-purple-600 text-white'\n                : 'bg-white text-gray-900 border border-gray-200 hover:bg-gray-50'\n            }`}\n          >\n            All Notifications ({stats.total})\n          </button>\n          <button\n            onClick={() => setFilter('unread')}\n            className={`px-4 py-2 rounded-lg font-medium transition ${\n              filter === 'unread'\n                ? 'bg-purple-600 text-white'\n                : 'bg-white text-gray-900 border border-gray-200 hover:bg-gray-50'\n            }`}\n          >\n            Unread ({stats.unread})\n          </button>\n          <button\n            onClick={() => fetchNotifications()}\n            className=\"ml-auto px-4 py-2 bg-white text-gray-900 rounded-lg border border-gray-200 hover:bg-gray-50 transition font-medium\"\n          >\n            Refresh\n          </button>\n        </div>\n\n        {/* Notifications List */}\n        <div className=\"space-y-3\">\n          {filteredNotifications.length === 0 ? (\n            <div className=\"bg-white rounded-lg shadow-md p-8 text-center\">\n              <div className=\"text-4xl mb-2\">üîî</div>\n              <p className=\"text-lg text-gray-600\">\n                {filter === 'unread' ? 'No unread notifications' : 'No notifications'}\n              </p>\n            </div>\n          ) : (\n            filteredNotifications.map((notification) => (\n              <div\n                key={notification.id}\n                className={`bg-white rounded-lg shadow-md p-4 transition ${\n                  !notification.read ? 'border-l-4 border-purple-600' : ''\n                }`}\n              >\n                <div className=\"flex items-start gap-4\">\n                  <div className=\"text-2xl mt-1\">{getTypeIcon(notification.type)}</div>\n\n                  <div className=\"flex-1\">\n                    <div className=\"flex items-start justify-between gap-2 mb-1\">\n                      <h3 className={`font-bold ${!notification.read ? 'text-gray-900' : 'text-gray-700'}`}>\n                        {notification.subject}\n                      </h3>\n                      <span className={`px-2 py-1 rounded text-xs font-semibold ${getTypeColor(notification.type)} whitespace-nowrap`}>\n                        {notification.type.replace(/_/g, ' ')}\n                      </span>\n                    </div>\n\n                    <p className=\"text-sm text-gray-600 mb-3\">{notification.message}</p>\n\n                    <div className=\"flex items-center justify-between\">\n                      <p className=\"text-xs text-gray-500\">\n                        {new Date(notification.created_at).toLocaleString()}\n                      </p>\n\n                      <div className=\"flex gap-2\">\n                        {notification.action_url && (\n                          <a\n                            href={notification.action_url}\n                            className=\"text-purple-600 hover:text-purple-700 font-medium text-sm\"\n                          >\n                            View ‚Üí\n                          </a>\n                        )}\n                        {!notification.read && (\n                          <button\n                            onClick={() => handleMarkAsRead(notification.id)}\n                            className=\"text-gray-600 hover:text-gray-900 font-medium text-sm\"\n                          >\n                            Mark as read\n                          </button>\n                        )}\n                      </div>\n                    </div>\n                  </div>\n                </div>\n              </div>\n            ))\n          )}\n        </div>\n      </div>\n    </div>\n  )\n}\n"],"names":[],"mappings":"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"}