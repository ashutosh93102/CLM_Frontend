module.exports=[87532,a=>{"use strict";let b=(0,a.i(70106).default)("search",[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]]);a.s(["Search",()=>b],87532)},84505,a=>{"use strict";let b=(0,a.i(70106).default)("download",[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]]);a.s(["Download",()=>b],84505)},46581,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(50944),e=a.i(84505);let f=(0,a.i(70106).default)("file-pen-line",[["path",{d:"m18.226 5.226-2.52-2.52A2.4 2.4 0 0 0 14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-.351",key:"1k2beg"}],["path",{d:"M21.378 12.626a1 1 0 0 0-3.004-3.004l-4.01 4.012a2 2 0 0 0-.506.854l-.837 2.87a.5.5 0 0 0 .62.62l2.87-.837a2 2 0 0 0 .854-.506z",key:"2t3380"}],["path",{d:"M8 18h1",key:"13wk12"}]]);var g=a.i(87532),h=a.i(52072),i=a.i(98448);function j(a){if(!a)return"—";let b=new Date(String(a));return Number.isNaN(b.getTime())?String(a):b.toLocaleString()}function k(a){return(String(a||"contract").trim()||"contract").replace(/[^a-zA-Z0-9._-]+/g,"_").slice(0,80)}async function l(a,b){let c=URL.createObjectURL(a),d=document.createElement("a");d.href=c,d.download=b,document.body.appendChild(d),d.click(),d.remove(),URL.revokeObjectURL(c)}let m=()=>{let a=(0,d.useRouter)(),[m,n]=(0,c.useState)([]),[o,p]=(0,c.useState)(!0),[q,r]=(0,c.useState)(null),[s,t]=(0,c.useState)("all"),[u,v]=(0,c.useState)(""),[w,x]=(0,c.useState)(null),y=(0,c.useRef)(0),z=async a=>{try{p(!0),r(null),y.current=Date.now();let b=new i.ApiClient,c=await b.inhouseListSigningRequests({q:a?.q,status:a?.status&&"all"!==a.status?a.status:void 0,limit:200,offset:0});if(!c.success){r(c.error||"Failed to fetch signing requests"),n([]);return}let d=Array.isArray(c.data?.results)?c.data.results:[];n(d)}catch(a){r(a instanceof Error?a.message:"Failed to fetch signing requests"),n([])}finally{p(!1)}};(0,c.useEffect)(()=>{z();let a=()=>z({q:u.trim()||void 0,status:s});return window.addEventListener("focus",a),()=>window.removeEventListener("focus",a)},[]),(0,c.useEffect)(()=>{let a=u.trim(),b=window.setTimeout(()=>{z({q:a||void 0,status:s})},250);return()=>window.clearTimeout(b)},[u,s]);let A=(0,c.useMemo)(()=>{let a=a=>m.filter(b=>String(b.status||"").toLowerCase()===a).length,b=a("sent"),c=a("in_progress")+a("in progress"),d=a("completed"),e=a("declined"),f=a("failed"),g=a("draft");return{total:m.length,draft:g,active:b+c,completed:d,declined:e+f}},[m]),B=b=>{a.push(`/contracts/signing-status?id=${encodeURIComponent(b)}&provider=inhouse`)},C=async a=>{let b=String(a.contract_id||"").trim();if(b)try{x(b),r(null);let c=new i.ApiClient,d=await c.inhouseDownloadExecutedPdf(b);if(!d.success||!d.data)return void r(d.error||"Failed to download executed PDF");let e=k(a.contract_title||"contract");await l(d.data,`${e}_signed.pdf`)}catch(a){r(a instanceof Error?a.message:"Failed to download executed PDF")}finally{x(null)}},D=async a=>{let b=String(a.contract_id||"").trim();if(b)try{x(b),r(null);let c=new i.ApiClient,d=await c.inhouseDownloadCertificate(b);if(!d.success||!d.data)return void r(d.error||"Failed to download certificate");let e=k(a.contract_title||"contract");await l(d.data,`${e}_certificate.pdf`)}catch(a){r(a instanceof Error?a.message:"Failed to download certificate")}finally{x(null)}};return(0,b.jsxs)(h.default,{children:[(0,b.jsxs)("div",{className:"flex items-center justify-between gap-4 mb-6",children:[(0,b.jsxs)("div",{className:"min-w-0",children:[(0,b.jsx)("h1",{className:"text-2xl md:text-3xl font-extrabold text-slate-900",children:"Signing Requests"}),(0,b.jsxs)("p",{className:"mt-2 text-sm text-slate-600",children:["Default provider: ",(0,b.jsx)("span",{className:"font-semibold",children:"In-house signing"})]})]}),(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsxs)("div",{className:"relative hidden sm:block",children:[(0,b.jsx)(g.Search,{className:"w-4 h-4 text-slate-400 absolute left-4 top-1/2 -translate-y-1/2"}),(0,b.jsx)("input",{value:u,onChange:a=>v(a.target.value),placeholder:"Search by contract or signer…",className:"w-[340px] bg-white border border-slate-200 rounded-full pl-11 pr-4 py-3 text-sm focus:outline-none focus:ring-2 focus:ring-rose-200"})]}),(0,b.jsxs)("button",{onClick:()=>a.push("/contracts"),className:"inline-flex items-center gap-2 rounded-full bg-[#0F141F] text-white px-5 py-3 text-sm font-semibold",children:[(0,b.jsx)(f,{className:"w-4 h-4"}),"Go to Contracts"]})]})]}),(0,b.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6",children:[{label:"Total",value:A.total},{label:"Draft",value:A.draft},{label:"Active",value:A.active},{label:"Completed",value:A.completed}].map(a=>(0,b.jsxs)("div",{className:"rounded-3xl bg-white border border-slate-200 p-6",children:[(0,b.jsx)("p",{className:"text-slate-500 text-sm",children:a.label}),(0,b.jsx)("p",{className:"text-4xl font-extrabold text-slate-900 mt-2",children:String(a.value).padStart(2,"0")})]},a.label))}),(0,b.jsxs)("div",{className:"bg-white rounded-3xl border border-slate-200 overflow-hidden",children:[(0,b.jsxs)("div",{className:"px-6 py-5 border-b border-slate-200 flex items-center justify-between flex-wrap gap-3",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-lg font-extrabold text-slate-900",children:"All Signing Requests"}),(0,b.jsxs)("p",{className:"text-sm text-slate-500 mt-1",children:[m.length," request",1!==m.length?"s":""]})]}),(0,b.jsx)("div",{className:"flex gap-2 flex-wrap",children:["all","draft","sent","in_progress","completed","declined","failed"].map(a=>(0,b.jsx)("button",{onClick:()=>t(a),className:`px-3 py-2 rounded-xl text-xs font-semibold border transition ${s===a?"bg-[#0F141F] text-white border-[#0F141F]":"bg-white text-slate-700 border-slate-200 hover:bg-slate-50"}`,children:"all"===a?"All":"in_progress"===a?"In Progress":a.charAt(0).toUpperCase()+a.slice(1)},a))})]}),(0,b.jsx)("div",{className:"divide-y divide-slate-200",children:o?(0,b.jsx)("div",{className:"py-16 text-center text-slate-500",children:"Loading signing requests…"}):q?(0,b.jsx)("div",{className:"py-16 text-center text-rose-600",children:q}):0===m.length?(0,b.jsx)("div",{className:"py-16 text-center text-slate-500",children:"No signing requests found"}):m.map(a=>{let c,d=String(a.contract_id||"").trim(),f=Array.isArray(a.signers)?a.signers:[],g=f.filter(a=>!!a?.has_signed||"signed"===String(a?.status||"").toLowerCase()).length,h="completed"===String(a.status||"").toLowerCase(),i=w===d;return(0,b.jsx)("div",{role:"button",tabIndex:0,onClick:()=>B(d),onKeyDown:a=>{("Enter"===a.key||" "===a.key)&&(a.preventDefault(),B(d))},className:"w-full text-left px-6 py-5 hover:bg-slate-50 transition cursor-pointer",children:(0,b.jsxs)("div",{className:"flex items-center justify-between gap-4",children:[(0,b.jsxs)("div",{className:"min-w-0",children:[(0,b.jsx)("p",{className:"font-semibold text-slate-900 truncate",children:a.contract_title||"Contract"}),(0,b.jsxs)("p",{className:"text-xs text-slate-500 mt-1 truncate",children:[d," • ",g,"/",f.length," signed"]}),(0,b.jsxs)("p",{className:"text-xs text-slate-500 mt-1 truncate",children:["Sent: ",j(a.sent_at)," • Updated: ",j(a.updated_at||a.last_activity_at)]})]}),(0,b.jsxs)("div",{className:"flex items-center gap-3 shrink-0",children:[(0,b.jsx)("span",{className:`inline-block px-3 py-1 rounded-full text-xs font-semibold border ${["completed","signed","executed","done","finished"].includes(c=String(a.status||"").trim().toLowerCase())?"bg-emerald-50 text-emerald-700 border-emerald-200":["declined","rejected","canceled","cancelled","refused","failed","error"].includes(c)?"bg-rose-50 text-rose-700 border-rose-200":["sent","invited","pending","in_progress","in progress","viewed","draft"].includes(c)?"bg-amber-50 text-amber-800 border-amber-200":"bg-slate-50 text-slate-700 border-slate-200"}`,children:String(a.status||"—").toUpperCase()}),h?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("button",{type:"button",onClick:b=>{b.preventDefault(),b.stopPropagation(),C(a)},disabled:i,className:"inline-flex items-center justify-center rounded-full bg-white border border-slate-200 text-slate-800 w-9 h-9 hover:bg-slate-50 disabled:opacity-50","aria-label":"Download executed PDF",title:"Download executed PDF",children:(0,b.jsx)(e.Download,{className:"w-4 h-4"})}),(0,b.jsx)("button",{type:"button",onClick:b=>{b.preventDefault(),b.stopPropagation(),D(a)},disabled:i,className:"inline-flex items-center justify-center rounded-full bg-white border border-slate-200 text-slate-800 w-9 h-9 hover:bg-slate-50 disabled:opacity-50","aria-label":"Download certificate",title:"Download certificate",children:(0,b.jsx)("span",{className:"text-xs font-extrabold",children:"C"})})]}):null,(0,b.jsx)("span",{className:"text-sm font-semibold text-slate-700",children:"View →"})]})]})},a.id)})})]})]})};function n(){return(0,b.jsx)(m,{})}a.s(["default",()=>n],46581)}];

//# sourceMappingURL=_464c65f3._.js.map